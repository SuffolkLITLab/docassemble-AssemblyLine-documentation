"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[6803],{7838:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var s=t(4848),o=t(8453);const a={id:"installation",title:"Installing the Document Assembly Line",sidebar_label:"Installation",slug:"/installation"},i=void 0,l={id:"installation",title:"Installing the Document Assembly Line",description:"Before you get started, make sure that you have [installed",source:"@site/docs/installation.md",sourceDirName:".",slug:"/installation",permalink:"/docassemble-AssemblyLine-documentation/docs/installation",draft:!1,unlisted:!1,editUrl:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/installation.md",tags:[],version:"current",frontMatter:{id:"installation",title:"Installing the Document Assembly Line",sidebar_label:"Installation",slug:"/installation"},sidebar:"get_started",previous:{title:"Project Architecture",permalink:"/docassemble-AssemblyLine-documentation/docs/al_project_architecture"},next:{title:"Bootcamp",permalink:"/docassemble-AssemblyLine-documentation/docs/bootcamp"}},r={},c=[{value:"Install ALDashboard",id:"install-aldashboard",level:2},{value:"Run the installation script",id:"run-the-installation-script",level:2},{value:"Customize the ALThemeTemplate repository",id:"customize-the-althemetemplate-repository",level:2},{value:"Using your ALThemeTemplate with the ALWeaver",id:"using-your-althemetemplate-with-the-alweaver",level:3},{value:"Docker-level server configuration changes we recommend",id:"docker-level-server-configuration-changes-we-recommend",level:2},{value:"Increase nginx timeouts to 5 minutes",id:"increase-nginx-timeouts-to-5-minutes",level:3},{value:"Replace the nginx 504 gateway timeout page",id:"replace-the-nginx-504-gateway-timeout-page",level:3},{value:"Monitor your server",id:"monitor-your-server",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Before you get started, make sure that you have ",(0,s.jsx)(n.a,{href:"https://suffolklitlab.org/legal-tech-class/docs/practical-guide-docassemble/setup-server",children:"installed\nDocassemble"}),"\non a server that you maintain."]}),"\n",(0,s.jsx)(n.p,{children:"Installing the Assembly Line covers the following basic steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Install the docassemble.ALDashboard package"}),"\n",(0,s.jsx)(n.li,{children:"Run the installation script"}),"\n",(0,s.jsxs)(n.li,{children:["Customize and install the\n",(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-ALThemeTemplate/",children:"ALThemeTemplate"}),"\npackage with branding and question wording to match your needs."]}),"\n",(0,s.jsx)(n.li,{children:"Use the Weaver tool to automate your labeled PDF or DOCX forms."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"install-aldashboard",children:"Install ALDashboard"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-ALDashboard",children:"ALDashboard"})," contains\nseveral features, but most importantly, it includes a menu-driven installation\nscript for the Assembly Line."]}),"\n",(0,s.jsx)(n.p,{children:"It will help you:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"install all required and optional Assembly Line packages"}),"\n",(0,s.jsx)(n.li,{children:"verify and configure short links, configuration changes, and API\nconfigurations"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To install ALDashboard:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:'visit the "Package Management" menu on your Docassemble server when you are\nlogged in as a server administrator'}),"\n",(0,s.jsxs)(n.li,{children:["Type ",(0,s.jsx)(n.code,{children:"docassemble.ALDashboard"})," into the input box labeled ",(0,s.jsx)(n.code,{children:"Package on PyPI"}),"\n",(0,s.jsx)(n.img,{alt:"Package on PyPI",src:t(5114).A+"",width:"724",height:"891"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click the ",(0,s.jsx)(n.strong,{children:"Update"})," button."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"run-the-installation-script",children:"Run the installation script"}),"\n",(0,s.jsxs)(n.p,{children:["Once ALDashboard is successfully installed, edit this link to replace\n",(0,s.jsx)(n.code,{children:"YOUR_SERVER"})," with the URL to your own Docassemble server and visit it."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"https://YOURSERVER.com/start/ALDashboard/menu\n"})}),"\n",(0,s.jsx)(n.p,{children:'Click the icon labeled "Install Assembly Line"'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Install assembly line",src:t(9720).A+"",width:"620",height:"589"})}),"\n",(0,s.jsx)(n.p,{children:"You will be asked to set up multiple APIs during the installation process.\nIf you do not have accounts yet, you can use the default choices for those\nrequests and return to them later."}),"\n",(0,s.jsx)(n.p,{children:"Specifically, you will be asked to setup:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/config.html#google",children:"Google Maps, Places, and Google Geocoding APIs"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/config.html#voicerss",children:"VoiceRSS"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/config.html#twilio",children:"Twilio SMS"})}),"\n",(0,s.jsxs)(n.li,{children:["an ",(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/config.html#mail",children:"email server"})," of your choice (we recommend Sendgrid)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"You will also be asked to create a GitHub private access token on a new\nGitHub account. This account should NOT be your primary account as it will\nbe used for automation."}),"\n",(0,s.jsx)(n.p,{children:"Walk through the guided menus to complete the installation. You can safely\ninstall all recommended packages and use all default configuration choices.\nIf you do not know the answer, you can return and manually edit your\nconfiguration later."}),"\n",(0,s.jsx)(n.h2,{id:"customize-the-althemetemplate-repository",children:"Customize the ALThemeTemplate repository"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-ALThemeTemplate/",children:"ALThemeTemplate"}),"\nis a docassemble package that includes an example of how to modify questions and customize\nthem for your own jurisdiction or organization."]}),"\n",(0,s.jsxs)(n.p,{children:["To use this package, ",(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/playground.html#packages",children:"pull it into your own Docassemble playground"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Next, ",(0,s.jsx)(n.a,{href:"/docassemble-AssemblyLine-documentation/docs/customization/overview",children:"follow our guide"})," to edit the YAML files and add a custom CSS theme to fit your own organization's needs."]}),"\n",(0,s.jsxs)(n.p,{children:["Now, create a new package from the ",(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/playground.html#packages",children:"Playground packages menu"}),".\nGive the package a meaningful name, like LouisianaSharedBranding.\nSelect the files that you customized and push them to your own Github repository."]}),"\n",(0,s.jsx)(n.admonition,{title:"Copy, do not fork",type:"info",children:(0,s.jsx)(n.p,{children:"It is important to copy and create a new package. Do not\nfork the ALThemeTemplate package as Docassemble makes it\nchallenging to rename a package."})}),"\n",(0,s.jsx)(n.h3,{id:"using-your-althemetemplate-with-the-alweaver",children:"Using your ALThemeTemplate with the ALWeaver"}),"\n",(0,s.jsxs)(n.p,{children:["If you plan on using the ",(0,s.jsx)(n.a,{href:"/docassemble-AssemblyLine-documentation/docs/generating_code",children:"ALWeaver"})," to create your\ninterviews, you will want to include your branding package in your\nweaved interviews. You can do this by adding 2 files to your branding\npackage:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/playground.html#modules",children:"In your modules folder"}),", create a file named ",(0,s.jsx)(n.code,{children:"advertise_weaver.py"})," and add the following contents:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# pre-load\nimport os\nfrom docassemble.ALWeaver.custom_values import advertise_capabilities\n\nif not os.environ.get('ISUNITTEST'):\n    advertise_capabilities(__name__, minimum_version=\"1.5\")\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://docassemble.org/docs/playground.html#sources",children:"In your sources folder"}),", create a file named ",(0,s.jsx)(n.code,{children:"configuration_capabilities.yml"})," (needs to have that exact spelling), and add the following contents:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'package name: My Package\norganization_choices:\n  - description: MyPackage\n    dependency: "docassemble.MyPackage @ https://github.com/MyOrg/docassemble-MyPackage/archive/main.zip"\n    include_name: "docassemble.MyPackage:custom_organization.yml"\n    state: TX\n    country: US\n    default: false\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You should replace ",(0,s.jsx)(n.code,{children:"MyOrg"})," and ",(0,s.jsx)(n.code,{children:"MyPackage"})," with the name of your GitHub organization and\nthe name you gave your custom branding package. If you changed the name of ",(0,s.jsx)(n.code,{children:"custom_organization.yml"}),",\nthe default name of the yaml in ",(0,s.jsx)(n.code,{children:"ALThemeTemplate"}),", in your package,\nyou should also change ",(0,s.jsx)(n.code,{children:"custom_organization.yml"})," above."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"docker-level-server-configuration-changes-we-recommend",children:"Docker-level server configuration changes we recommend"}),"\n",(0,s.jsx)(n.h3,{id:"increase-nginx-timeouts-to-5-minutes",children:"Increase nginx timeouts to 5 minutes"}),"\n",(0,s.jsx)(n.p,{children:'Sometimes, long-running Docassemble processes can "timeout." The default\nexperience in Docassemble is to show the server\'s built-in error page,\nwhich can be confusing for your end user.'}),"\n",(0,s.jsx)(n.p,{children:"We recommend that you increase the nginx timeout for uwsgi from 60 seconds\n(default) to 5 minutes to reduce the frequency that users run into this\nugly error screen."}),"\n",(0,s.jsx)(n.p,{children:"Unfortunately, this error page can only be changed by sshing into the\nserver and then entering the docker container."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"SSH to the server running Docker."}),"\n",(0,s.jsxs)(n.li,{children:["Type ",(0,s.jsx)(n.code,{children:'docker exec -ti $(docker ps --filter "ancestor=jhpyle/docassemble" --format {{.ID}}) /bin/bash'})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Install a text editor and open the nginx configuration file as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"apt update\napt install nano\nnano /etc/nginx/nginx.conf\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Add the following exact text to the ",(0,s.jsx)(n.code,{children:"http"})," section: ",(0,s.jsx)(n.code,{children:"uwsgi_read_timeout 300s;"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Edit uwsgi timeout",src:t(8350).A+"",width:"756",height:"479"})}),"\n",(0,s.jsx)(n.p,{children:"Type CTRL+O, Enter, and then CTRL+X to save and exit the configuration file."}),"\n",(0,s.jsx)(n.p,{children:"Type the following commands to restart the nginx process:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"supervisorctl restart nginx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"replace-the-nginx-504-gateway-timeout-page",children:"Replace the nginx 504 gateway timeout page"}),"\n",(0,s.jsxs)(n.p,{children:["The default ",(0,s.jsx)(n.code,{children:"nginx"})," timeout screen is a little menacing. It also does not give\nyou an indication that you can refresh the screen to try again, but often that\nlets you get past the timeout. But you can customize it."]}),"\n",(0,s.jsxs)(n.p,{children:["Here is a ",(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-ALToolbox/blob/main/docassemble/ALToolbox/data/static/custom_504.html",children:"custom HTML 504 gateway timeout\npage"}),"\nthat you could install with your own branding and that you can use to replace\nthe ",(0,s.jsx)(n.code,{children:"nginx"}),' default. It adds a "Reload" button that may allow your user to move\npast the error string.']}),"\n",(0,s.jsx)(n.p,{children:"First:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"SSH to the server running Docker."}),"\n",(0,s.jsxs)(n.li,{children:["Type ",(0,s.jsx)(n.code,{children:'docker exec -ti $(docker ps --filter "ancestor=jhpyle/docassemble" --format {{.ID}}) /bin/bash'})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Install a text editor:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"apt update\napt install nano\n"})}),"\n",(0,s.jsx)(n.p,{children:"Create a directory to store your custom configuration files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir /usr/share/nginx/html/errors\n"})}),"\n",(0,s.jsx)(n.p,{children:"Open a new nano editor:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nano /usr/share/nginx/html/errors/custom_504.html\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Copy and paste the contents  ",(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-ALToolbox/blob/main/docassemble/ALToolbox/data/static/custom_504.html",children:"custom HTML 504 gateway timeout\npage"}),"\ninto the open ",(0,s.jsx)(n.code,{children:"nano"})," editor on your server."]}),"\n",(0,s.jsx)(n.p,{children:"Type CTRL+O, Enter, and then CTRL+X to save and close the editor."}),"\n",(0,s.jsxs)(n.p,{children:["Edit the ",(0,s.jsx)(n.code,{children:"nginx"})," configuration file to point to your new custom error page:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nano /etc/nginx/nginx.conf\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Add this line of code to the configuration file, inside the main ",(0,s.jsx)(n.code,{children:"http"})," ",(0,s.jsx)(n.code,{children:"{}"}),"\nbrackets: ",(0,s.jsx)(n.code,{children:"error_page 504 /errors/custom_504.html;"})]}),"\n",(0,s.jsx)(n.p,{children:"Type CTRL+O, Enter, and then CTRL+X to save and close the editor."}),"\n",(0,s.jsx)(n.p,{children:"Restart the nginx process:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"supervisorctl restart nginx\n"})}),"\n",(0,s.jsx)(n.h2,{id:"monitor-your-server",children:"Monitor your server"}),"\n",(0,s.jsx)(n.p,{children:"There is always the chance that something goes wrong with your server when you aren't looking and that it goes down."}),"\n",(0,s.jsx)(n.p,{children:"We suggest using a service that can attempt to access your server periodically and notifies you if it goes down. Some options include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://uptimerobot.com/",children:"UptimeRobot"})}),"\n",(0,s.jsxs)(n.li,{children:["Using GitHub action's scheduled actions to attempt to access your server. The ",(0,s.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/ALActions/blob/main/.github/workflows/run_hall_monitor.yml",children:"SuffolkLITLab has an example of this type of GitHub action"}),", that you could copy and modify (we'd be happy to help your modify it for your needs)."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8350:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/edit_uwsgi_timeout-f817c70239d478813280066d3059a623.png"},9720:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/installation_install_assembly_line-5c8a4ecc58dc2a0a77a124c25d6037c6.png"},5114:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/installation_package_on_pypi-936cae986b2cb653cc7286c2983e6fb1.png"},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(6540);const o={},a=s.createContext(o);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);