"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[677],{420:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"components/AssemblyLine/translation","title":"Translating your interview","description":"The Assembly Line has several tools that build on Docassemble\'s native translation system","source":"@site/docs/components/AssemblyLine/translation.md","sourceDirName":"components/AssemblyLine","slug":"/components/AssemblyLine/translation","permalink":"/docs/components/AssemblyLine/translation","draft":false,"unlisted":false,"editUrl":"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/components/AssemblyLine/translation.md","tags":[],"version":"current","frontMatter":{"id":"translation","title":"Translating your interview","sidebar_label":"Translating your interview","slug":"translation"},"sidebar":"docs","previous":{"title":"Dynamic navigation sections","permalink":"/docs/components/AssemblyLine/navigation"},"next":{"title":"Error pages","permalink":"/docs/components/AssemblyLine/error_actions"}}');var t=a(4848),i=a(8453);const l={id:"translation",title:"Translating your interview",sidebar_label:"Translating your interview",slug:"translation"},o=void 0,r={},d=[{value:"Core concepts",id:"core-concepts",level:2},{value:"XLSX File format",id:"xlsx-file-format",level:3},{value:"What the translator sees",id:"what-the-translator-sees",level:3},{value:"Text that isn&#39;t translated using the XLSX translation system",id:"text-that-isnt-translated-using-the-xlsx-translation-system",level:3},{value:"Making a translation file",id:"making-a-translation-file",level:2},{value:"Variables used in translated interviews",id:"variables-used-in-translated-interviews",level:2},{value:"Make the translation file available in your interview",id:"make-the-translation-file-available-in-your-interview",level:2},{value:"Methods to change interview language",id:"methods-to-change-interview-language",level:2},{value:"Drop-down menu selector with <code>get_language_list_dropdown()</code>",id:"drop-down-menu-selector-with-get_language_list_dropdown",level:3},{value:"In-line language list with <code>get_language_list</code>",id:"in-line-language-list-with-get_language_list",level:3},{value:"Ask the user a question",id:"ask-the-user-a-question",level:3},{value:"Switching language on the fly",id:"switching-language-on-the-fly",level:3},{value:"Pre-launch in a specific language with special url parameter <code>lang</code>",id:"pre-launch-in-a-specific-language-with-special-url-parameter-lang",level:3},{value:"The <code>al_change_language</code> event",id:"the-al_change_language-event",level:2},{value:"A complete example",id:"a-complete-example",level:2},{value:"Customizing the native-language display of a language code by duplicating and editing <code>data/sources/languages.yml</code>",id:"customizing-the-native-language-display-of-a-language-code-by-duplicating-and-editing-datasourceslanguagesyml",level:2},{value:"Read more",id:"read-more",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"The Assembly Line has several tools that build on Docassemble's native translation system\nto help you offer your interview in multiple languages:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Widgets that you can display to allow the user to switch languages"}),"\n",(0,t.jsx)(n.li,{children:"A tool to generate blank translation XLSX files and a tool to help get translation quotes"}),"\n",(0,t.jsx)(n.li,{children:"Special variables to turn translation on and off and make it more convenient to list the available languages\nin your interview."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"core-concepts",children:"Core concepts"}),"\n",(0,t.jsx)(n.h3,{id:"xlsx-file-format",children:"XLSX File format"}),"\n",(0,t.jsxs)(n.p,{children:["Docassemble interviews can be translated by adding a special Excel spreadsheet (XLSX format)\nin the ",(0,t.jsx)(n.code,{children:"sources"}),' folder of your package. Docassemble\'s translation system\nworks without requiring you to maintain multiple YAML files. The translated phrases are loaded\n"live" when you run your interview.']}),"\n",(0,t.jsx)(n.p,{children:"In the XLSX file, the translator sees two columns: one with English (or your source language)\nphrases, and an empty column where they can write the translated phrases."}),"\n",(0,t.jsx)(n.h3,{id:"what-the-translator-sees",children:"What the translator sees"}),"\n",(0,t.jsxs)(n.p,{children:["Any mako tags that you used, for example, ",(0,t.jsx)(n.code,{children:"${ variable }"}),", will be visible in the English\nversion of the cell, but will be highlighted in a distinct color. Similarly, HTML will also\nbe highlighted."]}),"\n",(0,t.jsx)(n.h3,{id:"text-that-isnt-translated-using-the-xlsx-translation-system",children:"Text that isn't translated using the XLSX translation system"}),"\n",(0,t.jsx)(n.p,{children:"Some parts of the interview require special handling:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Buttons and system phrases need to be translated in a ",(0,t.jsx)(n.code,{children:"words.yml"})," file."]}),"\n",(0,t.jsxs)(n.li,{children:["Blocks that do not use Mako, like the ",(0,t.jsx)(n.code,{children:"sections"})," block, need to be translated\nin-place with the ",(0,t.jsx)(n.code,{children:"language"})," modifier."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"making-a-translation-file",children:"Making a translation file"}),"\n",(0,t.jsx)(n.p,{children:'Use the ALDashboard\'s "Prepare Translation Files" menu item to make a new translation file,\nready to send to your translator.'}),"\n",(0,t.jsx)(n.p,{children:"The tool also will calculate how many words in the given language need to be translated,\nwithout counting Mako and HTML code. The number it provides is suitable for you to share\nwith a translation vendor."}),"\n",(0,t.jsx)(n.p,{children:"Note that if you have several YAML pathways in your interview, you may encounter duplicate\nphrases across the translation files. Most vendors will have an automated method to detect\nthis."}),"\n",(0,t.jsx)(n.h2,{id:"variables-used-in-translated-interviews",children:"Variables used in translated interviews"}),"\n",(0,t.jsxs)(n.p,{children:["These variables control the Assembly Line's language system. For a complete list of\nall Assembly Line special variables, see ",(0,t.jsx)(n.a,{href:"/docs/components/AssemblyLine/magic_variables",children:"Special variables"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enable_al_language"}),": defaults to True, turning it off can partially ensure the language system in AssemblyLine doesn't interfere with existing language systems. It should be relatively easy for authors to migrate to this new system though."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"al_user_default_language"}),': can be controlled by interview author, this determines the language when the user makes no selection of their own. Defaults to "en".']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"al_interview_languages"}),': a list of language codes, presumably ISO-639-1 (Alpha-2), like ["en","es"] etc. The Assembly Line also contains a translation of several common language codes into the native-language version of the language (e.g., ',(0,t.jsx)(n.code,{children:"es"})," is translated as ",(0,t.jsx)(n.code,{children:"Espa\xf1ol"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"al_user_language"}),": normally set via a dropdown menu or passed as a URL argument, this stores the user's current selected language"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"make-the-translation-file-available-in-your-interview",children:"Make the translation file available in your interview"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Add the new XLSX file into ",(0,t.jsx)(n.code,{children:"sources"})," folder in your package."]}),"\n",(0,t.jsxs)(n.li,{children:["Add a ",(0,t.jsx)(n.code,{children:"translations"})," block"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"translations:\n  - MyPackage.xlsx\n"})}),"\n",(0,t.jsxs)(n.admonition,{title:"Add the translation block up top",type:"caution",children:[(0,t.jsxs)(n.p,{children:["Because of the way translations are loaded,\nyou need to add the translations block ",(0,t.jsx)(n.strong,{children:"before"}),"\nany other questions or includes in your interview."]}),(0,t.jsxs)(n.p,{children:["If you have the ",(0,t.jsx)(n.code,{children:"translations"})," block later in your\nfile, it won't have any effect on questions defined\ncloser to the top of the file."]})]}),"\n",(0,t.jsx)(n.h2,{id:"methods-to-change-interview-language",children:"Methods to change interview language"}),"\n",(0,t.jsxs)(n.h3,{id:"drop-down-menu-selector-with-get_language_list_dropdown",children:["Drop-down menu selector with ",(0,t.jsx)(n.code,{children:"get_language_list_dropdown()"})]}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(n.code,{children:"al_interview_languages"})," is defined (which is the default) and has at least 2 items,\nthe Assembly Line will add a drop-down menu item in the top right that allows the user\nto switch languages at any time."]}),"\n",(0,t.jsx)(n.p,{children:"You can customize this drop-down menu with a block like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'---\ndefault screen parts:\n  navigation bar html: |\n    % if enable_al_language and len(al_interview_languages) > 1:\n    ${ get_language_list_dropdown(al_interview_languages,current=al_user_language, extra_class="text-dark", icon="fa-solid fa-language fa-xl" ) }\n    % endif\n'})}),"\n",(0,t.jsxs)(n.p,{children:["By using your own ",(0,t.jsx)(n.code,{children:"navigation bar html"})," block, you can customize the ",(0,t.jsx)(n.code,{children:"icon"})," and ",(0,t.jsx)(n.code,{children:"extra_class"})," parameters.\nUse ",(0,t.jsx)(n.code,{children:"extra_class"})," ",(0,t.jsx)(n.code,{children:"text-dark"})," if your navigation bar is light, rather than the default dark navigation bar\ncolor. This class applies to the ",(0,t.jsx)(n.code,{children:"anchor"})," tag that surrounds the icon."]}),"\n",(0,t.jsxs)(n.p,{children:["By default the icon is the ",(0,t.jsxs)(n.a,{href:"https://fontawesome.com/search?q=language&o=r",children:["FontAwesome ",(0,t.jsx)(n.code,{children:"language"})," icon"]}),"\nat size ",(0,t.jsx)(n.code,{children:"xl"})," (extra large). You can customize the ",(0,t.jsx)(n.code,{children:"icon"})," parameter with a unique icon name and any other\nFontAwesome custom ",(0,t.jsx)(n.a,{href:"https://docs.fontawesome.com/web/style/styling",children:"styling options"}),"."]}),"\n",(0,t.jsxs)(n.h3,{id:"in-line-language-list-with-get_language_list",children:["In-line language list with ",(0,t.jsx)(n.code,{children:"get_language_list"})]}),"\n",(0,t.jsxs)(n.p,{children:["On the first screen of the interview, you may want to just show the user a list of the languages directly in the ",(0,t.jsx)(n.code,{children:"subquestion"})," area, where it is more visible,\nrather than directing them to the dropdown menu."]}),"\n",(0,t.jsxs)(n.p,{children:["You can call ",(0,t.jsx)(n.code,{children:"get_language_list()"})," to achieve this."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"subquestion: |\n  ${ get_language_list(lang_codes=al_interview_languages, current=al_user_language) }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ask-the-user-a-question",children:"Ask the user a question"}),"\n",(0,t.jsx)(n.p,{children:"If you want to be absolutely sure that the user encounters the language\nquestion, you can directly ask the user a question:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"id: language\nquestion: |\n    What language / que idioma?\nfields:\n    - Language/idioma: al_user_language\n      datatype: radio\n      choices:\n        - English: en\n        - Espa\xf1ol: es\n"})}),"\n",(0,t.jsx)(n.h3,{id:"switching-language-on-the-fly",children:"Switching language on the fly"}),"\n",(0,t.jsx)(n.p,{children:'Make sure that expert users of your tool, like advocates\nshadowing or looking over the shoulder of an unrepresented\nlitigant, know that they can use the dropdown menu to switch\nlanguage "live."'}),"\n",(0,t.jsx)(n.p,{children:"For example, the SRL can work through the interview on their own\nuntil a point at which they get stuck. Then the helper can change\nto English to understand what is happening on the screen, and speak\nwith an interpreter to give the SRL instructions."}),"\n",(0,t.jsx)(n.p,{children:"This can be helpful for bilingual assistance\nsettings."}),"\n",(0,t.jsxs)(n.h3,{id:"pre-launch-in-a-specific-language-with-special-url-parameter-lang",children:["Pre-launch in a specific language with special url parameter ",(0,t.jsx)(n.code,{children:"lang"})]}),"\n",(0,t.jsxs)(n.p,{children:["If you would like to share the interview in a bilingual landing\npage rather than forcing the user to change the language\ndynamically, use the ",(0,t.jsx)(n.code,{children:"lang=CODE"})," URL argument."]}),"\n",(0,t.jsx)(n.p,{children:"E.g.,"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"https://apps.suffolklitlab.org/start/uptocode/?lang=es"})}),"\n",(0,t.jsx)(n.p,{children:"The interview will launch in the language specified by\nthe language code (if it is translated into that language)"}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:["If the URL already has a ",(0,t.jsx)(n.code,{children:"?"})," in it, replace the ",(0,t.jsx)(n.code,{children:"?"})," with an ",(0,t.jsx)(n.code,{children:"&"}),"."]}),(0,t.jsx)(n.p,{children:"(this is a standard part of URL arguments)."})]}),"\n",(0,t.jsxs)(n.h2,{id:"the-al_change_language-event",children:["The ",(0,t.jsx)(n.code,{children:"al_change_language"})," event"]}),"\n",(0,t.jsxs)(n.p,{children:["The Assembly Line language system uses a special event called ",(0,t.jsx)(n.code,{children:"al_change_language"}),"\nto handle language switching. This event is triggered automatically when a user\nclicks on a language selection link generated by functions like\n",(0,t.jsx)(n.code,{children:"get_language_list_dropdown()"})," or ",(0,t.jsx)(n.code,{children:"get_language_list()"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"When the event is triggered, it:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Reads the ",(0,t.jsx)(n.code,{children:"lang"})," parameter from the action arguments"]}),"\n",(0,t.jsxs)(n.li,{children:["Sets ",(0,t.jsx)(n.code,{children:"al_user_language"})," to the selected language code"]}),"\n",(0,t.jsxs)(n.li,{children:["Calls Docassemble's ",(0,t.jsx)(n.code,{children:"set_language()"})," function to apply the language change"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You normally don't need to handle this event directly, as it's managed automatically\nby the language switching functions. However, if you want to add custom behavior\nwhen languages are switched, you can define additional logic after the language\nchange:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"event: al_change_language\ncode: |\n  # The built-in language switching happens first\n  if 'lang' in action_arguments():\n    al_user_language = action_argument('lang')\n    set_language(al_user_language)\n  \n  # Add your custom logic here\n  log(f\"User switched to language: {al_user_language}\")\n"})}),"\n",(0,t.jsx)(n.h2,{id:"a-complete-example",children:"A complete example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'---\ntranslations:\n  - my_interview_es.xlsx # The translation file list should be the first section of the interview\n---\ninclude:\n  - docassemble.AssemblyLine:assembly_line.yml\n---\nmetadata:\n  title: My interview\n---\ncode: |\n  al_interview_languages = ["en", "es"]  # List each available language, including English, using the ISO code\n---\ndefault screen parts:\n  # Customizing this section isn\'t required. Here\n  navigation bar html: |\n    % if enable_al_language and len(al_interview_languages) > 1:\n    ${ get_language_list_dropdown(al_interview_languages,current=al_user_language, extra_class="text-dark", icon="fa-solid fa-language fa-xl" ) }\n    % endif\n---\nsections:\n  - section_intro: Getting started\n  - section_you: About you\n  - section_case: About your court case\n  - section_defenses: Claims and defenses\n  - review_eviction_answer: Review your answers\n  - section_download: Download, print, deliver, and file\n---\nlanguage: es # The sections block is NOT in the interview translation XLSX file\nsections:\n  - section_intro: Empezar\n  - section_you: Sobre usted\n  - section_case: Sobre su caso judicial\n  - section_defenses: Reclamaciones y defensas\n  - review_eviction_answer: Revisar sus respuestas\n  - section_download: Descargar, imprimir, entregar y presentar  \n---\nid: intro\nquestion: |\n  File a My Interview document\nsubquestion: |\n  Use this interview to file a "MyInterview" document in 3 steps:\n\n  1. ...\n  2. ...\n  3. ...\npre: |\n  ${ get_language_list(lang_codes=al_interview_languages, current=al_user_language) }\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"customizing-the-native-language-display-of-a-language-code-by-duplicating-and-editing-datasourceslanguagesyml",children:["Customizing the native-language display of a language code by duplicating and editing ",(0,t.jsx)(n.code,{children:"data/sources/languages.yml"})]}),"\n",(0,t.jsxs)(n.p,{children:["When it is possible, the dropdown menu of languages provided by the Assembly Line will display the language name in the native\nname for that language. E.g.,  ",(0,t.jsx)(n.code,{children:"es"})," is translated as ",(0,t.jsx)(n.code,{children:"Espa\xf1ol"}),".\nWe didn't find a standard Python library that provides this functionality, so this functionality is provided by a file named\n",(0,t.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine/blob/main/docassemble/AssemblyLine/data/sources/languages.yml",children:'"languages.yml"'}),".\nWe manually translated the codes for about 45 common first languages for migrants to the United States."]}),"\n",(0,t.jsxs)(n.p,{children:["If you have a language your interview is available in that isn't contained in this file, you can copy\nand customize the ",(0,t.jsx)(n.a,{href:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine/blob/main/docassemble/AssemblyLine/data/sources/languages.yml",children:'"languages.yml"'}),".\n",(0,t.jsxs)(n.strong,{children:["Be sure to place the customized file in the ",(0,t.jsx)(n.code,{children:"data/sources/"})," folder in your Docassemble package, not in the normal ",(0,t.jsx)(n.code,{children:"questions"})," folder."]}),"\nThe custom version will be substituted\nfor the built-in version. Most US-based legal aid providers won't find it necessary to customize this\nfile. We also welcome pull requests to add to the list of supported languages."]}),"\n",(0,t.jsxs)(n.p,{children:["If a language code is not listed in ",(0,t.jsx)(n.code,{children:"languages.yml"}),", the Assembly Line functions try the following strategies, in order:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Uses an English-language translation of the language code. E.g., ",(0,t.jsx)(n.code,{children:"es"})," is listed as ",(0,t.jsx)(n.code,{children:"Spanish"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Displays the literal language code. E.g., ",(0,t.jsx)(n.code,{children:"es"})," stays ",(0,t.jsx)(n.code,{children:"es"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"read-more",children:"Read more"}),"\n",(0,t.jsxs)(n.p,{children:["You can read more about the stock language features in the official Docassemble ",(0,t.jsx)(n.a,{href:"https://docassemble.org/docs/language.html",children:"language features documentation"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Also, see the documentation for the ",(0,t.jsx)(n.a,{href:"/docs/components/AssemblyLine/language",children:"AL language module"})," for complete API documentation of all language-related functions."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>o});var s=a(6540);const t={},i=s.createContext(t);function l(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);