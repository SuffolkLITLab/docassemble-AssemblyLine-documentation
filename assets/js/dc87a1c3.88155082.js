"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[7135],{1113:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"components/formfyxer/docx_wrangling","title":"formfyxer.docx_wrangling","description":"* formfyxer.docx\\\\wrangling","source":"@site/docs/components/formfyxer/docx_wrangling.md","sourceDirName":"components/formfyxer","slug":"/components/formfyxer/docx_wrangling","permalink":"/docs/components/formfyxer/docx_wrangling","draft":false,"unlisted":false,"editUrl":"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/components/formfyxer/docx_wrangling.md","tags":[],"version":"current","frontMatter":{}}');var i=r(4848),o=r(8453);const s={},d="formfyxer.docx_wrangling",a={},l=[{value:"update_docx",id:"update_docx",level:3},{value:"Arguments",id:"arguments",level:4},{value:"Returns",id:"returns",level:4},{value:"get_docx_repr",id:"get_docx_repr",level:3},{value:"Arguments",id:"arguments-1",level:4},{value:"Returns",id:"returns-1",level:4},{value:"get_labeled_docx_runs",id:"get_labeled_docx_runs",level:3},{value:"Arguments",id:"arguments-2",level:4},{value:"Returns",id:"returns-2",level:4},{value:"get_modified_docx_runs",id:"get_modified_docx_runs",level:3},{value:"Arguments",id:"arguments-3",level:4},{value:"Returns",id:"returns-3",level:4},{value:"make_docx_plain_language",id:"make_docx_plain_language",level:3},{value:"modify_docx_with_openai_guesses",id:"modify_docx_with_openai_guesses",level:3},{value:"Arguments",id:"arguments-4",level:4},{value:"Returns",id:"returns-4",level:4}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"formfyxerdocx_wrangling",children:"formfyxer.docx_wrangling"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling",children:"formfyxer.docx_wrangling"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.update_docx",children:"update_docx"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.get_docx_repr",children:"get_docx_repr"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.get_labeled_docx_runs",children:"get_labeled_docx_runs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.get_modified_docx_runs",children:"get_modified_docx_runs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.make_docx_plain_language",children:"make_docx_plain_language"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#formfyxer.docx_wrangling.modify_docx_with_openai_guesses",children:"modify_docx_with_openai_guesses"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.update_docx"}),"\n",(0,i.jsx)(n.h3,{id:"update_docx",children:"update_docx"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def update_docx(\n        document: Union[docx.document.Document, str],\n        modified_runs: List[Tuple[int, int, str,\n                                  int]]) -> docx.document.Document\n"})}),"\n",(0,i.jsx)(n.p,{children:"Update the document with the modified runs."}),"\n",(0,i.jsx)(n.p,{children:"Note: OpenAI is probabilistic, so the modified run indices may not be correct.\nWhen the index of a run or paragraph is out of range, a new paragraph\nwill be inserted at the end of the document or a new run at the end of the\nparagraph's runs."}),"\n",(0,i.jsx)(n.p,{children:"Take a careful look at the output document to make sure it is still correct."}),"\n",(0,i.jsx)(n.h4,{id:"arguments",children:"Arguments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"document"})," - the docx.Document object, or the path to the DOCX file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"modified_runs"})," - a tuple of paragraph number, run number, the modified text, a question (not used), and whether a new paragraph should be inserted (for conditional text)"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:"The modified document."}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.get_docx_repr"}),"\n",(0,i.jsx)(n.h3,{id:"get_docx_repr",children:"get_docx_repr"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get_docx_repr(docx_path: str,\n                  paragraph_start: int = 0,\n                  paragraph_end: Optional[int] = None)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Return a JSON representation of the paragraphs and runs in the DOCX file."}),"\n",(0,i.jsx)(n.h4,{id:"arguments-1",children:"Arguments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_path"})," - path to the DOCX file"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"returns-1",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:"A JSON representation of the paragraphs and runs in the DOCX file."}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.get_labeled_docx_runs"}),"\n",(0,i.jsx)(n.h3,{id:"get_labeled_docx_runs",children:"get_labeled_docx_runs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get_labeled_docx_runs(\n        docx_path: Optional[str] = None,\n        docx_repr=Optional[str],\n        custom_people_names: Optional[Tuple[str, str]] = None,\n        openai_client: Optional[OpenAI] = None,\n        api_key: Optional[str] = None) -> List[Tuple[int, int, str, int]]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Scan the DOCX and return a list of modified text with Jinja2 variable names inserted."}),"\n",(0,i.jsx)(n.h4,{id:"arguments-2",children:"Arguments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_path"})," - path to the DOCX file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_repr"})," - a string representation of the paragraphs and runs in the DOCX file, if docx_path is not provided. This might be useful if you want"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"custom_people_names"}),' - a tuple of custom names and descriptions to use in addition to the default ones. Like: ("clients", "the person benefiting from the form")']}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"returns-2",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:"A list of tuples, each containing a paragraph number, run number, and the modified text of the run."}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.get_modified_docx_runs"}),"\n",(0,i.jsx)(n.h3,{id:"get_modified_docx_runs",children:"get_modified_docx_runs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def get_modified_docx_runs(docx_path: Optional[str] = None,\n                           docx_repr: Optional[str] = None,\n                           custom_example: str = "",\n                           instructions: str = "",\n                           openai_client: Optional[OpenAI] = None,\n                           api_key: Optional[str] = None,\n                           temperature=0.5) -> List[Tuple[int, int, str, int]]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Use GPT to rewrite the contents of a DOCX file paragraph by paragraph. Does not handle tables, footers, or\nother structures yet."}),"\n",(0,i.jsx)(n.p,{children:"This is a light wrapper that provides the structure of DOCX paragraphs and runs to your prompt\nto OpenAI to facilitate the rewriting of the document without disrupting formatting."}),"\n",(0,i.jsx)(n.p,{children:"For example, this could be used to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Remove any passive voice"}),"\n",(0,i.jsx)(n.li,{children:"Replace placeholder text with variable names"}),"\n",(0,i.jsx)(n.li,{children:"Rewrite to a 6th grade reading level"}),"\n",(0,i.jsx)(n.li,{children:"Do an advanced search and replace, without requiring you to use a regex"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"By default, the example prompt includes a sample like this:"}),"\n",(0,i.jsx)(n.p,{children:'[\n[0, 0, "Dear "],\n[0, 1, "John Smith:"],\n[1, 0, "I hope this letter finds you well."],\n]'}),"\n",(0,i.jsx)(n.p,{children:"Your custom instructions should include an example of how the sample will be modified, like the one below:"}),"\n",(0,i.jsx)(n.p,{children:"Example reply, indicating paragraph, run, the new text, and a number indicating if this changes the\ncurrent paragraph, adds one before, or adds one after (-1, 0, 1):"}),"\n",(0,i.jsx)(n.p,{children:'{"results":\n[\n[0, 1, "Dear {{ other_parties[0] }}:", 0],\n[2, 0, "{%p if is_tenant %}", -1],\n[3, 0, "{%p endif %}", 1],\n]\n}'}),"\n",(0,i.jsx)(n.p,{children:"You may also want to customize the input example to better match your use case."}),"\n",(0,i.jsx)(n.h4,{id:"arguments-3",children:"Arguments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_path"})," ",(0,i.jsx)(n.em,{children:"str"})," - path to the DOCX file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_repr"})," ",(0,i.jsx)(n.em,{children:"str"})," - a string representation of the paragraphs and runs in the DOCX file, if docx_path is not provided."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"custom_example"})," ",(0,i.jsx)(n.em,{children:"Optional[str]"})," - a string containing the purpose and overview of the task\ninstructions (str) a string containing specific instructions for the task"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"openai_client"})," ",(0,i.jsx)(n.em,{children:"Optional[OpenAI]"})," - an OpenAI client object. If not provided a new one will be created."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"api_key"})," ",(0,i.jsx)(n.em,{children:"Optional[str]"})," - an OpenAI API key. If not provided, it will be obtained from the environment"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"temperature"})," ",(0,i.jsx)(n.em,{children:"float"})," - the temperature to use when generating text. Lower temperatures are more conservative."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"returns-3",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:"A list of tuples, each containing a paragraph number, run number, and the modified text of the run."}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.make_docx_plain_language"}),"\n",(0,i.jsx)(n.h3,{id:"make_docx_plain_language",children:"make_docx_plain_language"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def make_docx_plain_language(docx_path: str) -> docx.document.Document\n"})}),"\n",(0,i.jsx)(n.p,{children:"Convert a DOCX file to plain language with the help of OpenAI."}),"\n",(0,i.jsx)("a",{id:"formfyxer.docx_wrangling.modify_docx_with_openai_guesses"}),"\n",(0,i.jsx)(n.h3,{id:"modify_docx_with_openai_guesses",children:"modify_docx_with_openai_guesses"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def modify_docx_with_openai_guesses(docx_path: str) -> docx.document.Document\n"})}),"\n",(0,i.jsx)(n.p,{children:"Uses OpenAI to guess the variable names for a document and then modifies the document with the guesses."}),"\n",(0,i.jsx)(n.h4,{id:"arguments-4",children:"Arguments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx_path"})," ",(0,i.jsx)(n.em,{children:"str"})," - Path to the DOCX file to modify."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"returns-4",children:"Returns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docx.Document"})," - The modified document, ready to be saved to the same or a new path"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>d});var t=r(6540);const i={},o=t.createContext(i);function s(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);