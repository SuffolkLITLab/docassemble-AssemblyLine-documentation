"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[7987],{4137:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=o.createContext({}),u=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),h=n,m=p["".concat(l,".").concat(h)]||p[h]||d[h]||r;return a?o.createElement(m,s(s({ref:t},c),{},{components:a})):o.createElement(m,s({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:n,s[1]=i;for(var u=2;u<r;u++)s[u]=a[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,a)}h.displayName="MDXCreateElement"},2598:(e,t,a)=>{a.d(t,{IO:()=>s,oc:()=>i,tD:()=>r});var o=a(7294),n=a(3699);const r=e=>!0===e.plain?o.createElement("span",null,"GitHub+You\u2122"):o.createElement(n.Z,{to:"/docs/alkiln/setup#githubNyou-details"},"GitHub+You\u2122"),s=e=>!0===e.plain?o.createElement("span",null,"ALKilnInThePlayground\u2122"):o.createElement(n.Z,{to:"/docs/alkiln/setup#diy-details"},"ALKilnInThePlayground\u2122"),i=e=>!0===e.plain?o.createElement("span",null,"GitHub Sandbox\u2122"):o.createElement(n.Z,{to:"/docs/alkiln/setup#sandbox-details"},"GitHub Sandbox\u2122")},551:(e,t,a)=>{a.d(t,{ZP:()=>s});var o=a(7462),n=(a(7294),a(4137));const r={toc:[]};function s(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,o.Z)({},r,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Since ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"workflow environment variables")," might hold sensitive information, ALKiln avoids taking pictures or downloading the HTML of pages that use environment variables, even when the test has an error on that page. ALKiln avoids printing the value of an environment variable anywhere in the ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#reports"},"report")," or in the ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#console"},"console log"),"."))}s.isMDXComponent=!0},6133:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>u,toc:()=>p});var o=a(7462),n=(a(7294),a(4137)),r=a(551),s=a(2598);const i={id:"alkiln_security",title:"Security",sidebar_label:"WIP Security",slug:"/alkiln/security"},l=void 0,u={unversionedId:"alkiln/alkiln_security",id:"alkiln/alkiln_security",title:"Security",description:"WIP (Work in progress)",source:"@site/docs/alkiln/security.mdx",sourceDirName:"alkiln",slug:"/alkiln/security",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/security",draft:!1,editUrl:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/alkiln/security.mdx",tags:[],version:"current",frontMatter:{id:"alkiln_security",title:"Security",sidebar_label:"WIP Security",slug:"/alkiln/security"},sidebar:"docs",previous:{title:"WIP Troubleshooting & errors",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/trouble"},next:{title:"WIP Older versions",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/old"}},c={},p=[{value:"Principle of least privilege",id:"privilege",level:2},{value:"Separate production and testing",id:"testing-server",level:3},{value:"Use fake data in tests",id:"mock-data",level:3},{value:"Make accounts just for tests",id:"test-accounts",level:3},{value:"ALKiln account role",id:"alkiln_role",level:3},{value:"Still protect sensitive data",id:"sensitive-data",level:2},{value:"Avoid sensitive data in package files",id:"sensitive-info-files",level:3},{value:"Avoid showing sensitive data on screen",id:"no-show",level:3},{value:"Avoid JSON Steps with sensitive data",id:"json-vars",level:3},{value:"How to use sensitive data in GitHub tests",id:"sensitive-info-github",level:3},{value:"How to use sensitive data in  ALKilnInThePlayground  <AutoDIY/> tests",id:"sensitive-info-diy",level:3},{value:" GitHub Sandbox  <KittyLitter/> tests",id:"sandbox",level:3},{value:"Freeze your ALKiln version (advanced)",id:"freeze",level:2},{value:"Update your tools",id:"upgrade",level:2},{value:"Update ALKiln when needed",id:"upgrade-ALKiln",level:3},{value:"Update docassemble",id:"upgrade-da",level:3},{value:"Start a new Docker container regularly",id:"upgrade-docker",level:3},{value:"General GitHub practices",id:"github",level:2},{value:"Protect pull requests",id:"prs",level:3},{value:"GitHub logs and artifacts are public",id:"github-output",level:3},{value:"Protect your default branch",id:"default-branch",level:3},{value:"Use GitHub&#39;s recommended workflow practices",id:"github-workflow",level:3},{value:"Things to worry about less",id:"things-to-worry-about-less",level:2},{value:"Worry less: Your production server",id:"production",level:3},{value:"Worry less: GitHub redacts secrets",id:"github-redacts-secrets",level:3},{value:"Worry less:  ALKilnInThePlayground  <AutoDIY/> tests already freeze your ALKiln version",id:"playground-version",level:3},{value:"Worry less: You can disable tests",id:"disable",level:2},{value:"ALKiln protects you too",id:"alkilns-precautions",level:2},{value:"ALKlin is limited",id:"limited",level:3},{value:"ALKiln hides environment variables",id:"alkiln-env-vars",level:3},{value:"ALKiln reports its security updates",id:"alkiln-logs",level:3},{value:"ALKiln freezes the versions of its dependencies",id:"alkiln-freezes-dependencies",level:3},{value:"ALKiln updates its dependencies",id:"alkiln-deps",level:3},{value:"ALKiln protects its major branches",id:"alkiln-branches",level:3},{value:"ALKiln uses good action file practices",id:"alkiln-action-files",level:3},{value:"You can report an ALKiln security vulnerability",id:"report",level:3}],d={toc:p};function h(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,o.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{type:"warning"},(0,n.kt)("p",{parentName:"admonition"},"WIP (Work in progress)")),(0,n.kt)("p",null,"This page will help you learn some steps you can take to protect yourself and your users as you develop your code with ALKiln tests. It will also talk about the ",(0,n.kt)("a",{parentName:"p",href:"#alkilns-precautions"},"security practices ALKiln itself uses"),"."),(0,n.kt)("p",null,"In software development, security can be an intimidating topic. By design, ALKiln tests are unable to do very much, but all software comes with risks. We can mitigate those risks with robust security measures. Over time, we can all build up our security tool chests to:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Protect our users' information"),(0,n.kt)("li",{parentName:"ul"},"Protect our security-critical information"),(0,n.kt)("li",{parentName:"ul"},"Protect our servers")),(0,n.kt)("p",null,"We want to protect against anything that might expose or modify any important or sensitive data."),(0,n.kt)("p",null,"One of our strongest tools to increase security is the ",(0,n.kt)("a",{parentName:"p",href:"#privilege"},"principle of least privilege"),"."),(0,n.kt)("h2",{id:"privilege"},"Principle of least privilege"),(0,n.kt)("p",null,"Follow the ",(0,n.kt)("a",{parentName:"p",href:"https://www.cyberark.com/what-is/least-privilege/"},"principle of least privilege"),". That means we should give software (or people) the least access possible to your server and data while still letting them do what they need to do. For example, if someone just needs to fill out an interview, give them the ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/users.html"},"role"),' of "user", not "developer". If someone needs to develop interviews, give them the role of "developer", not "admin".'),(0,n.kt)("p",null,"It is one of the most effective ways to protect yourself and your users. Only give ALKiln the access it needs and no more."),(0,n.kt)("p",null,"Personal data is information about real people, whether that is ",(0,n.kt)("a",{parentName:"p",href:"#mock-data"},"old information or new information"),". Security-critical data includes passwords, usernames, ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/api.html#manage_api"},"API keys"),", and other credentials."),(0,n.kt)("p",null,"If you are worried you have already shown sensitive information in your GitHub tests, you can delete your ",(0,n.kt)("a",{parentName:"p",href:"#github-output"},"logs and artifacts"),"."),(0,n.kt)("h3",{id:"testing-server"},"Separate production and testing"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," server admins"),(0,n.kt)("p",null,"Using a separate testing server and separate testing data are some of the most effective ways to limit ALKiln's access to personal and security-critical data."),(0,n.kt)("p",null,"There are some kinds of tests that packages run on their production server, but ALKiln is in a different category of tests. Limiting ALKiln's access means that it:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Never has access to actual user information"),(0,n.kt)("li",{parentName:"ul"},"Never has access to your production server's security-critical data like configuration tokens"),(0,n.kt)("li",{parentName:"ul"},"Never has access to your current or old production databases"),(0,n.kt)("li",{parentName:"ul"},"Can never affect the files on your production server")),(0,n.kt)("p",null,"First and foremost, avoid installing or running ",(0,n.kt)(s.tD,{mdxType:"GTOYS"})," and ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests on your production server",(0,n.kt)("sup",{parentName:"p",id:"fnref-bonus"},(0,n.kt)("a",{parentName:"sup",href:"#fn-bonus",className:"footnote-ref"},"bonus")),". Have a separate server for those testing methods. ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," tests already make their own server and can be the most secure if you ",(0,n.kt)("a",{parentName:"p",href:"#sandbox"},"use them properly"),". Use those if you are ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/setup#sandbox-cons"},"able to use them"),"."),(0,n.kt)("p",null,"A separate server is only one part of separating production and testing sever access, though. You also need to:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Keep the production server's urls out of ALKiln test files, ",(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#workflows"},"workflow files"),", and ",(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"workflow environment variables"),"."),(0,n.kt)("li",{parentName:"ul"},"Never share API keys or passwords between servers."),(0,n.kt)("li",{parentName:"ul"},"Never share real data or databases between servers, whether the data is current or ",(0,n.kt)("a",{parentName:"li",href:"https://www.wired.com/2015/11/samy-kamkar-10-dollar-tool-can-guess-and-steal-your-next-credit-card-number/"},"old"),".")),(0,n.kt)("h3",{id:"mock-data"},"Use fake data in tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for"),": Everyone"),(0,n.kt)("p",null,"Determined people can do a lot with very little data. For example, they can ",(0,n.kt)("a",{parentName:"p",href:"https://www.wired.com/2007/12/why-anonymous-data-sometimes-isnt"},"even use anonymized data")," to identify your users. Avoid giving your ALKiln tests access to real data, even if it is ",(0,n.kt)("a",{parentName:"p",href:"https://www.wired.com/2015/11/samy-kamkar-10-dollar-tool-can-guess-and-steal-your-next-credit-card-number/"},"old data"),". If you need help creating fake data, sites or tools like ",(0,n.kt)("a",{parentName:"p",href:"https://cobbl.io/"},"https://cobbl.io/")," might be useful."),(0,n.kt)("p",null,"If your test needs a logged-in user, avoid using a real person's account. Instead, use ",(0,n.kt)("a",{parentName:"p",href:"#test-accounts"},"ALKiln's account")," or a completely separate fake account."),(0,n.kt)("p",null,"Never use a database with real information with your tests, even old information. For example:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Never share data between your production server and your testing server. For example, if your production server uses a Google spreadsheet to store some user or server data, create a separate Google spreadsheet with fake data for your testing server."),(0,n.kt)("li",{parentName:"ul"},"Never use old databases. Some projects realize that they should avoid using their current user database for testing. Instead, they decide to use an old database. Avoid that as well. Even if the data seems so old that it is useless, it can still ",(0,n.kt)("a",{parentName:"li",href:"https://www.wired.com/2015/11/samy-kamkar-10-dollar-tool-can-guess-and-steal-your-next-credit-card-number/"},"expose you and your users"),".")),(0,n.kt)("h3",{id:"test-accounts"},"Make accounts just for tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Even though you are using a ",(0,n.kt)("a",{parentName:"p",href:"#testing-server"},"testing server"),", avoid giving ALKiln access to an actual developer's name, username, password, API keys, and other sensitive information by giving ALKiln its own accounts. This also lets you see its activity in the logs more clearly and lets you delete the account easily if you need to. There are non-security related reasons to make a separate account too",(0,n.kt)("sup",{parentName:"p",id:"fnref-perks"},(0,n.kt)("a",{parentName:"sup",href:"#fn-perks",className:"footnote-ref"},"perks")),"."),(0,n.kt)("p",null,"Only give ALKiln an account if necessary. Make sure no one else uses the account. Give that account ",(0,n.kt)("a",{parentName:"p",href:"#alkiln_role"},"a role with only the privileges it needs")," and no more. Also, avoid giving it other real data or access. For example, avoid giving it any real person's name and avoid giving it GitHub integration."),(0,n.kt)("p",null,'We usually call the ALKiln user "automated_tests" and give it the email "',(0,n.kt)("a",{parentName:"p",href:"mailto:automated_tests@example.com"},"automated_tests@example.com"),'" with a secure password.'),(0,n.kt)("p",null,"The ",(0,n.kt)(s.tD,{mdxType:"GTOYS"})," tests need to be connected to a docassemble account with the ",(0,n.kt)("a",{parentName:"p",href:"#alkiln_role"},"right role"),' (permissions) to work properly. That is the "developer" role. Even if you are using another type of test, though, your tests may need an account. For example, you may want a test to sign in to an account before going to an interview.'),(0,n.kt)("p",null,'If you do need an account to sign in before a test, think of that account as a separate account because you might be able to give that account even less access. If the sign-in account can just be a user, make a new account just for signing in that just has a "user" role.'),(0,n.kt)("p",null,"If you stop needing an account, delete it."),(0,n.kt)("h3",{id:"alkiln_role"},"ALKiln account role"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"ALKiln strongly limits what tests can do. Even so, you should limit ALKiln too by giving it the fewest permissions possible."),(0,n.kt)("p",null,"For ",(0,n.kt)(s.tD,{mdxType:"GTOYS"}),' tests, give the ALKiln docassemble account the "developer" ',(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/users.html"},"role"),'. "Developer" is the most limited role ALKiln can use with ',(0,n.kt)(s.tD,{mdxType:"GTOYS"})," tests to do what it needs to do. When you make an API key for the account, ignore the ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/config.html#permissions"},"extra permissions")," options."),(0,n.kt)("p",null,"If your ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"}),' tests need an account on your server, give them the least privileges possible. In those cases, most authors only need to give ALKiln the "user" role.'),(0,n.kt)("p",null,"The ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," tests run on their own server, create their own account, and manage their own permissions."),(0,n.kt)("h2",{id:"sensitive-data"},"Still protect sensitive data"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Even after keeping personal and security-critical data away from ",(0,n.kt)("a",{parentName:"p",href:"#test-accounts"},"the account that runs ALKiln tests"),", there are still ways you can expose your test server's sensitive data in tests. Even if you are using a testing server, that server still has credentials, like API keys and passwords, and you should avoid exposing those to the ALKiln tests."),(0,n.kt)("h3",{id:"sensitive-info-files"},"Avoid sensitive data in package files"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Avoid putting personal or security-critical information in your package's files. It is possible that someone will see those files. For example, if you have a public repository on GitHub, anyone can see your package's files."),(0,n.kt)("p",null,"If you need to use sensitive information in your tests:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"For tests running in GitHub, ",(0,n.kt)("a",{parentName:"li",href:"#sensitive-info-github"},"add a GitHub secret")),(0,n.kt)("li",{parentName:"ul"},"For ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests, ",(0,n.kt)("a",{parentName:"li",href:"#sensitive-info-diy"},"add a variable in your docassemble configuration file"))),(0,n.kt)("h3",{id:"no-show"},"Avoid showing sensitive data on screen"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Avoid visually showing personal or security-critical data on an interview page. For example, you can show a server config value on an interview page in the text of a ",(0,n.kt)("inlineCode",{parentName:"p"},"subquestion"),". Even though you yourself can try to avoid ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#pics"},"taking pictures")," of those pages, an error can happen on that page. ALKiln takes pictures of pages that error and there is no way that ALKiln can know what text you are choosing to show to the user."),(0,n.kt)("p",null,"Using ALKiln to fill in answers in the interview is different. You can safely use sensitive information to fill in fields by using the ",(0,n.kt)("a",{parentName:"p",href:"#secret-val"},'"secret value" Step'),"."),(0,n.kt)(r.ZP,{mdxType:"SecureEnvVars"}),(0,n.kt)("h3",{id:"json-vars"},"Avoid JSON Steps with sensitive data"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#get-json"},'"get JSON"')," and ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#compare-json"},'"compare JSON"')," Steps show a page's JSON variables by logging them, saving them in a file, or both. ALKiln is currently unable to filter out sensitive values - personal or security-critical data - in that JSON. Only use those Steps when you are sure the JSON will be safe to show."),(0,n.kt)("h3",{id:"sensitive-info-github"},"How to use sensitive data in GitHub tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"To do this you MUST be:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Either the GitHub repository admin or"),(0,n.kt)("li",{parentName:"ul"},"The GitHub organization admin")),(0,n.kt)("p",null,"These are the only people that can create ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#secrets"},"GitHub secrets")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"It can help to know about:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#secrets"},"GitHub secrets")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"Workflow environment variables")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"Editing GitHub files"))),(0,n.kt)("p",null,'Sometimes authors do need to pass personal or security-critical information to their tests. For example, some tests require the "user" to ',(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing##sign-in"},"sign in"),", so the tests need to know the email and password for that user. In GitHub, you can do this securely by using ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#secrets"},"GitHub secrets")," and adding environment variables to your repository's GitHub workflow file. You can also read about ",(0,n.kt)("a",{parentName:"p",href:"#sensitive-info-diy"},"how to use sensitive information with ",(0,n.kt)(s.IO,{plain:!0,mdxType:"AutoDIY"})," tests"),"."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Follow the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets"},"GitHub instructions")," to set up one or more GitHub secrets. You can add these secrets to one secrets or you can add these to your organization",(0,n.kt)("sup",{parentName:"li",id:"fnref-org_secrets"},(0,n.kt)("a",{parentName:"sup",href:"#fn-org_secrets",className:"footnote-ref"},"org_secrets")),", whichever is right for you."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#workflows-where"},"Find your workflow file"),"."),(0,n.kt)("li",{parentName:"ol"},"It should include a line that looks similar to this:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},"jobs:\n  alkiln-tests:\n    runs-on: ubuntu-latest\n    name: Run ALKiln tests\n")),(0,n.kt)("p",null,"If this is the first environment variable you're adding, right below that last line add a new line like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},"    env:\n")),(0,n.kt)("ol",{start:4},(0,n.kt)("li",{parentName:"ol"},"Whenever you want to add a secret, add a new line under ",(0,n.kt)("inlineCode",{parentName:"li"},"env:")," indented from ",(0,n.kt)("inlineCode",{parentName:"li"},"env:"),":")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'      ALKILN_USER_PASSWORD: "${{ secrets.ALKILN_USER_PASSWORD }}"\n')),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"ALKILN_USER_PASSWORD")," is just a placeholder in our example. You can name your secrets whatever you want to. Make sure the name here matches your GitHub secret name."),(0,n.kt)("ol",{start:5},(0,n.kt)("li",{parentName:"ol"},"Write your Step and use the names of these secrets as the values. For example:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-gherkin"},'  And I set the variable "very_secure_password" to "ALKILN_USER_PASSWORD"\n')),(0,n.kt)("p",null,"Your workflow file code will end up including something like the below:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'# Other workflow code\n\njobs:\n  alkiln-tests:\n    runs-on: ubuntu-latest\n    name: Run ALKiln tests\n    env:\n      ALKILN_USER_PASSWORD: "${{ secrets.ALKILN_USER_PASSWORD }}"\n\n# Other workflow code\n')),(0,n.kt)("p",null,'We recommend that you start your environment variable names with "ALKILN_". That will help avoid conflicting with the environment variables of your operating system.'),(0,n.kt)(r.ZP,{mdxType:"SecureEnvVars"}),(0,n.kt)("p",null,"Right now, Story Tables are unable to use ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"workflow environment variables")," to fill in fields."),(0,n.kt)("h3",{id:"sensitive-info-diy"},"How to use sensitive data in "," ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"To do this you MUST be able to:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Edit your docassemble server's config file")),(0,n.kt)("p",null,'Sometimes authors do need to pass personal or security-critical information to their tests. For example, some tests require the "user" to log in, so the tests need to know the email and password for that user. You can do this securely in your ',(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests by adding this information to your docassemble server configuration file. ALKiln will use these as ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"environment variables")," for your tests."),(0,n.kt)("p",null,"You can also read about ",(0,n.kt)("a",{parentName:"p",href:"#sensitive-info-github"},"how to use sensitive information in GitHub tests"),"."),(0,n.kt)("p",null,"To do this, ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/config.html#edit"},"edit your docassemble server's configuration file")," to add your ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"environment variables")," under the ",(0,n.kt)("inlineCode",{parentName:"p"},"alkiln")," key. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},"# Other config values\nalkiln:\n  ALKILN_USER_PASSWORD: 123password\n")),(0,n.kt)("p",null,"Then use that environment variable name in your test. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-gherkin"},'  And I set the variable "very_secure_password" to "ALKILN_USER_PASSWORD"\n')),(0,n.kt)("p",null,'We recommend that you start your environment variable names with "ALKILN_". That will help avoid conflicting with the environment variables of your operating system.'),(0,n.kt)(r.ZP,{mdxType:"SecureEnvVars"}),(0,n.kt)("p",null,"Right now, Story Tables are unable to use ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"workflow environment variables")," to fill in fields."),(0,n.kt)("h3",{id:"sandbox"}," ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," have ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," tests"),(0,n.kt)("p",null,"The ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," are very secure if you use them correctly. You still have to take some care."),(0,n.kt)("p",null,"In your tests, avoid using urls that lead to your server. That is, avoid using ",(0,n.kt)("inlineCode",{parentName:"p"},"https://my-server.com")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"https://testing.my-server.com")," and interviews there or other pages there. That kind of url will send the tests to your server, which escapes the sandbox that makes the ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," method so useful. Using urls like that makes the tests less secure again."),(0,n.kt)("p",null,"You also still have to avoid saving personal or security-critical information in public files and follow other security precautions, like the ones described in this documentation."),(0,n.kt)("h2",{id:"freeze"},"Freeze your ALKiln version (advanced)"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"It can help to know about:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"Editing GitHub files")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#workflow-inputs"},"GitHub workflow job inputs")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://semver.org/spec/v2.0.0.html"},"Semantic versioning")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/about-commits#about-commits"},"Git commit ids")," (usually called the commit SHA",(0,n.kt)("sup",{parentName:"li",id:"fnref-sha"},(0,n.kt)("a",{parentName:"sup",href:"#fn-sha",className:"footnote-ref"},"SHA"))," or hash)")),(0,n.kt)("p",null,'To control which version of ALKiln is running your tests on GitHub, you can manually set the exact version you want. That is called "freezing" the version. Then, when you are ready, you can look at what has changed and decide which version you want to update to.'),(0,n.kt)("p",null,"By default, ALKiln runs your tests with its latest version. This means you have all the latest bug fixes and new features. Some organizations choose to use a version that has code and behavior that is familiar and comfortable for them."),(0,n.kt)("p",null,"ALKiln is actually made of 2 parts. One part is the ALKiln framework, which lets you control the robot that goes to your interview and fills in answers. Another part of ALKiln is its GitHub actions, which manage setting up, starting, and cleaning up the tests."),(0,n.kt)("p",null,'Because of factors out of our control, each of these parts has a different way to set the version. To freeze the framework, you need to use the semantic version number. For example, "5.8.0". To freeze the actions, you need to use the 40-character git commit id. Both of those need to point to the same',(0,n.kt)("sup",{parentName:"p",id:"fnref-ish"},(0,n.kt)("a",{parentName:"sup",href:"#fn-ish",className:"footnote-ref"},"ish"))," code. For example, the ",(0,n.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@suffolklitlab/alkiln/v/5.8.0"},'semantic version "5.8.0"')," of the ALKiln framework should be paired with the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/commit/e79eb61cb97603d41375134d505e4fe60de7780d"},"git commit with the id e79eb61cb97603d41375134d505e4fe60de7780d")," that controls the actions. To freeze your version:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Find the semantic version that you want.",(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},"Look at the ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/ALKiln/blame/-/package.json"},'"git blame" for our package.json'),"."),(0,n.kt)("li",{parentName:"ol"},"Find the 3rd line. It should be the line that shows ALKiln's version."),(0,n.kt)("li",{parentName:"ol"},"To ",(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/using-files/viewing-a-file#viewing-the-line-by-line-revision-history-for-a-file"},"see the previous version"),", you can tap on this symbol: ",(0,n.kt)("svg",{ariaHidden:"true",focusable:"false",role:"img",className:"octicon octicon-versions",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor",style:{display:"inline-block","user-select":"none","vertical-align":"text-bottom",overflow:"visible"}},(0,n.kt)("path",{d:"M7.75 14A1.75 1.75 0 0 1 6 12.25v-8.5C6 2.784 6.784 2 7.75 2h6.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14Zm-.25-1.75c0 .138.112.25.25.25h6.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-6.5a.25.25 0 0 0-.25.25ZM4.9 3.508a.75.75 0 0 1-.274 1.025.249.249 0 0 0-.126.217v6.5c0 .09.048.173.126.217a.75.75 0 0 1-.752 1.298A1.75 1.75 0 0 1 3 11.25v-6.5c0-.649.353-1.214.874-1.516a.75.75 0 0 1 1.025.274ZM1.625 5.533h.001a.249.249 0 0 0-.126.217v4.5c0 .09.048.173.126.217a.75.75 0 0 1-.752 1.298A1.748 1.748 0 0 1 0 10.25v-4.5a1.748 1.748 0 0 1 .873-1.516.75.75 0 1 1 .752 1.299Z"}))),(0,n.kt)("li",{parentName:"ol"},"Go back in history by tapping on that symbol until you find the version you are looking for. For example, ",(0,n.kt)("inlineCode",{parentName:"li"},"5.8.0"),"."))),(0,n.kt)("li",{parentName:"ol"},"Find the matching commit id.",(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},"Tap on the commit message for that line."),(0,n.kt)("li",{parentName:"ol"},"In the ",(0,n.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Address_bar"},"address bar")," of your web browser, look for a 40-character long set of random letters and numbers. The whole address might look something like this: ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/ALKiln/commit/e79eb61cb97603d41375134d505e4fe60de7780d"},"https://github.com/SuffolkLITLab/ALKiln/commit/e79eb61cb97603d41375134d505e4fe60de7780d"),". In that example url, the commit id (or SHA",(0,n.kt)("sup",{parentName:"li",id:"fnref-sha"},(0,n.kt)("a",{parentName:"sup",href:"#fn-sha",className:"footnote-ref"},"SHA")),") is ",(0,n.kt)("inlineCode",{parentName:"li"},"e79eb61cb97603d41375134d505e4fe60de7780d"),"."))),(0,n.kt)("li",{parentName:"ol"},"Set both versions.",(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#workflows-where"},"Find your workflow file"),"."),(0,n.kt)("li",{parentName:"ol"},"Tap to ",(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"edit the file"),"."),(0,n.kt)("li",{parentName:"ol"},"Go to the lines that look similar to the ones below.")))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'        uses: SuffolkLITLab/ALKiln@v5\n        with:\n          SERVER_URL: "${{ secrets.SERVER_URL }}"\n          DOCASSEMBLE_DEVELOPER_API_KEY: "${{ secrets.DOCASSEMBLE_DEVELOPER_API_KEY }}"\n')),(0,n.kt)("ol",{start:4},(0,n.kt)("li",{parentName:"ol"},"Replace ",(0,n.kt)("inlineCode",{parentName:"li"},"v5")," with the commit id you found. For example, ",(0,n.kt)("inlineCode",{parentName:"li"},"a29519914ffc235802be9b9b143d78ffc3a06028"),"."),(0,n.kt)("li",{parentName:"ol"},"Add a line below ",(0,n.kt)("inlineCode",{parentName:"li"},"DOCASSEMBLE_DEVELOPER_API_KEY"),". The indentation level should be the same as ",(0,n.kt)("inlineCode",{parentName:"li"}," DOCASSEMBLE_DEVELOPER_API_KEY"),"."),(0,n.kt)("li",{parentName:"ol"},"Add the text ",(0,n.kt)("inlineCode",{parentName:"li"},'ALKILN_VERSION: ""')),(0,n.kt)("li",{parentName:"ol"},"Between the quotes, put the semantic version that matches the commit id. For example, ",(0,n.kt)("inlineCode",{parentName:"li"},"5.8.0"),"."),(0,n.kt)("li",{parentName:"ol"},"Save the file.")),(0,n.kt)("p",null,"Using the example above, the final code should look something like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'        uses: SuffolkLITLab/ALKiln@a29519914ffc235802be9b9b143d78ffc3a06028\n        with:\n          SERVER_URL: "${{ secrets.SERVER_URL }}"\n          DOCASSEMBLE_DEVELOPER_API_KEY: "${{ secrets.DOCASSEMBLE_DEVELOPER_API_KEY }}"\n          ALKILN_VERSION: "5.8.0"\n')),(0,n.kt)("h2",{id:"upgrade"},"Update your tools"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Update your tools, especially when that update includes a security fix. Security updates are meant to protect you from newly discovered risks."),(0,n.kt)("p",null,"Choosing when to update to the latest version of software can be tricky. New features and bug fixes can interfere with your working system. That said, when there is a security update you should seriously think about upgrading quickly."),(0,n.kt)("p",null,'Your tools should keep a record of their changes, often called a "changelog". This is ',(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/blob/-/CHANGELOG.md"},"ALKiln's changelog"),". This is ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/changelog.html"},"docassemble's changelog"),". However, your software tracks changes, those records should clearly label security updates. Keep an eye out for those updates."),(0,n.kt)("h3",{id:"upgrade-ALKiln"},"Update ALKiln when needed"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Check ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/blob/-/CHANGELOG.md"},"ALKiln's changelog")," for updates and update regularly, especially when there is a security update."),(0,n.kt)("p",null,'Security updates will have the heading "Security". For example, ',(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/blob/-/CHANGELOG.md#security-1"},"this is one of ALKiln's security updates"),"."),(0,n.kt)("h3",{id:"upgrade-da"},"Update docassemble"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," server admins"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/admin.html#upgrade"},"Upgrade your testing server's docassemble version")," quickly when there is a security update. Then run all your tests before upgrading your production server too."),(0,n.kt)("p",null,"With most updates, you can usually wait a little while to see if there are any bugs that come up and get fixed. You should deal with a security fix more quickly. If possible, you then want to update your production server too, to make sure your testing server and your production server are using the same version. That helps make your tests more accurate."),(0,n.kt)("h3",{id:"upgrade-docker"},"Start a new Docker container regularly"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," server admins"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/docker.html#upgrading"},"Clear out the testing server and start a new docker container from scratch")," when there are security upgrades. Then run all your tests before upgrading your production server too."),(0,n.kt)("p",null,"Docassemble's Docker image gets updated occasionally. You can wait a little while to see if there are any bugs that come up, but generally keep up to date with those as much as you can, especially when there are security fixes."),(0,n.kt)("p",null,"Even if there is not a security-related update, it is good to stress test your server setup. Since you might have to suddenly start a new Docker container at unexpected times because of system failures, it is a good idea to do this every now and then anyway to make sure your system can handle recovering from that kind of event and see if complications come up."),(0,n.kt)("p",null,"If possible, you then want to update your production server too, to make sure your testing server and your production server are using the same version. That helps make your tests more accurate."),(0,n.kt)("h2",{id:"github"},"General GitHub practices"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"There are some ways to make your GitHub repository itself more secure that have nothing to do with ALKiln."),(0,n.kt)("h3",{id:"prs"},"Protect pull requests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"It is possible for you to add code to your ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#workflows"},"workflow file")," to ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#pr-trigger"},"trigger tests when someone makes a pull request")," on GitHub. If you decide to do that, take extra steps to make sure malicious coders are unable to trigger your workflows."),(0,n.kt)("p",null,"If you configure your workflows to be triggered by a pull request, someone can change the code of the tests, workflows, or other package code to do something malicious, then trigger that code by just making a pull request."),(0,n.kt)("p",null,"By default, GitHub ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/managing-workflow-runs/approving-workflow-runs-from-public-forks"},"prevents first-time contributors from triggering pull request workflows without your permission"),". Unfortunately, some people make first-time contributions that are very reasonable, like fixing typos. Once you accept that contribution, they are then able to trigger workflows with their pull requests. Before making that pull request, they can edit the code of the tests, the workflow, or the rest of the interview to contain malicious code."),(0,n.kt)("p",null,"You can make those settings more strict ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#controlling-changes-from-forks-to-workflows-in-public-repositories"},"for public repositories")," and ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/organizations/managing-organization-settings/disabling-or-limiting-github-actions-for-your-organization#configuring-required-approval-for-workflows-from-public-forks"},"for organizations"),". One setting makes sure no outside collaborator can trigger workflows with a pull request without your approval."),(0,n.kt)("p",null,"Private repositories can ignore this since they would first have to share their repository with an outside collaborator, presumably someone they trust. If they do want to collaborate with unfamiliar people, private repositories can also ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#enabling-workflows-for-forks-of-private-repositories"},"require approval from forks"),"."),(0,n.kt)("h3",{id:"github-output"},"GitHub logs and artifacts are public"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"On GitHub, workflow job logs and artifacts of public repositories are visible to the public, just like the code. Also, any logged-in user can download those workflow artifacts."),(0,n.kt)("p",null,"That might be fine. Part of being transparent is letting the public understand how your packages are working. Also, there are ",(0,n.kt)("a",{parentName:"p",href:"#secret-val"},"some ways")," ALKiln lets you set variables that you want to keep secret. That said, if you are concerned about your logs and artifacts, there are some things you can do to make these less available:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Make your repository private"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/using-workflow-run-logs#deleting-logs"},"Delete the logs")," and ",(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/managing-workflow-runs/removing-workflow-artifacts"},"delete the artifacts"),"."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#setting-the-retention-period-for-a-repository"},"Automatically delete the workflow data sooner"),". By default, GitHub keeps them for ",(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#configuring-the-retention-period-for-github-actions-artifacts-and-logs-in-your-repository"},"90 days"),".")),(0,n.kt)(r.ZP,{mdxType:"SecureEnvVars"}),(0,n.kt)("h3",{id:"default-branch"},"Protect your default branch"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," have a repository in GitHub"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"To do this you MUST be:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Either the GitHub repository admin or"),(0,n.kt)("li",{parentName:"ul"},"The GitHub organization admin")),(0,n.kt)("p",null,"You can protect your packages from unintended changes or changes by new collaborators by protecting your default branch."),(0,n.kt)("p",null,'Your default branch is usually called "main". That branch usually has the code that you run on your server and that other packages use. For that reason, many packages ',(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches"},"protect their default branch from unexpected changes"),"."),(0,n.kt)("p",null,"For example, you can require that:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Contributors make new branches when they edit code"),(0,n.kt)("li",{parentName:"ul"},"Contributors make a pull request before new code can be added to the main branch"),(0,n.kt)("li",{parentName:"ul"},"Administrators have to approve the pull request before that code can be merged")),(0,n.kt)("p",null,"You can allow administrators to skip these restrictions if you want."),(0,n.kt)("h3",{id:"github-workflow"},"Use GitHub's recommended workflow practices"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," have a repository in GitHub"),(0,n.kt)("p",null,"GitHub has documentation about ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions"},"keeping your GitHub workflows secure"),". We cover some of that content in here, but you can read that documentation for more."),(0,n.kt)("p",null,"You can specifically look at ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-third-party-actions"},"GitHub's recommendations for using third-party actions"),", like the ALKiln actions."),(0,n.kt)("h2",{id:"things-to-worry-about-less"},"Things to worry about less"),(0,n.kt)("p",null,"There are some security protections that you have by default."),(0,n.kt)("h3",{id:"production"},"Worry less: Your production server"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"As long as you ensure you ",(0,n.kt)("a",{parentName:"p",href:"#testing-server"},"only test on your testing server"),", ALKiln cannot affect your production server. You will have new files in your package, but they are unable to do anything by themselves."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("inlineCode",{parentName:"li"},".feature"),' files that you have in your "Sources" folder do nothing by themselves. They are as safe as text files.'),(0,n.kt)("li",{parentName:"ul"},"The GitHub workflow files can only run on GitHub.")),(0,n.kt)("h3",{id:"github-redacts-secrets"},"Worry less: GitHub redacts secrets"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"In your GitHub ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/quickstart#viewing-your-workflow-results"},"workflow run console"),", GitHub redacts any text that matches the values of your ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#secrets"},"GitHub secrets"),'. It replaces that text with "',"*","*","*",'". Note that the text must be an exact match. GitHub is unable to recognize partial matches.'),(0,n.kt)("p",null,"If you are worried about logs or artifacts that already exist, you can ",(0,n.kt)("a",{parentName:"p",href:"#github-output"},"delete those"),"."),(0,n.kt)("h3",{id:"playground-version"},"Worry less: "," ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests already freeze your ALKiln version"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," use ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests"),(0,n.kt)("p",null,"The ALKiln framework lets you control the robot that goes through your interview answering questions. This documentation has already discussed how ",(0,n.kt)("a",{parentName:"p",href:"#freeze"},"you can freeze your ALKiln versions on GitHub"),"."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"#alkilns-precautions"},"ALKiln itself already uses practices that protect you from malicious actors"),". If you want to take extra precautions, though, freezing the version you are using with ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," tests does give you more control over what code you are installing on your server and using to run your tests."),(0,n.kt)("p",null,"The first page of the ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," interview lets you choose "," the exact version of ALKiln that runs your tests. You can upgrade or downgrade at any time."),(0,n.kt)("h2",{id:"disable"},"Worry less: You can disable tests"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"If you ever become uncomfortable or concerned about your ALKiln tests, there are ",(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/setup#disable"},"multiple ways you can disable them"),"."),(0,n.kt)("h2",{id:"alkilns-precautions"},"ALKiln protects you too"),(0,n.kt)("p",null,"Our team takes special precautions with ALKiln's code to ensure you are as safe as we can make you. We are always looking for more ways to improve our security practices."),(0,n.kt)("h3",{id:"limited"},"ALKlin is limited"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"By design, the ALKiln framework is very limited in what it lets a test do. A test can:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#interact"},"Interact with interviews")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#sign-in"},"Sign in")," to an account if you give it the email and password"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#go-anywhere"},"Go to whatever site you give it"),", though it is unable to do much on non-docassemble-interview sites"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#observe"},"Observe things about interview pages"))),(0,n.kt)("p",null,"With ",(0,n.kt)(s.tD,{mdxType:"GTOYS"})," tests, ALKiln must have ",(0,n.kt)("a",{parentName:"p",href:"#alkiln_role"},"developer privileges")," to set up the tests, but the tests themselves are just like an unregistered person online. For other types of test methods - ",(0,n.kt)(s.IO,{mdxType:"AutoDIY"})," and ",(0,n.kt)(s.oc,{mdxType:"KittyLitter"})," tests - ALKiln doesn't even need a an account on your docassemble server."),(0,n.kt)("h3",{id:"alkiln-env-vars"},"ALKiln hides environment variables"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/writing#env-vars"},"Workflow environment variables")," might contain sensitive information. Because of this, ALKiln takes extra care with them."),(0,n.kt)(r.ZP,{mdxType:"SecureEnvVars"}),(0,n.kt)("admonition",{title:"JSON variables",type:"danger"},(0,n.kt)("p",{parentName:"admonition"},"You do need to ",(0,n.kt)("a",{parentName:"p",href:"#json-vars"},"take care when you use JSON Steps"),".")),(0,n.kt)("h3",{id:"alkiln-logs"},"ALKiln reports its security updates"),(0,n.kt)("p",null,"When ALKiln has a security update, we announce it on ",(0,n.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/support.html#slack"},"docassemble's Slack channel")," and post it in ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/blob/-/CHANGELOG.md"},"ALKiln's changelog"),'. The Slack channel is called "#alkiln-automated-testing".'),(0,n.kt)("p",null,'Security updates have the heading "Security". For example, ',(0,n.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/ALKiln/blob/-/CHANGELOG.md#security-1"},"this is one of ALKiln's security updates"),"."),(0,n.kt)("h3",{id:"alkiln-freezes-dependencies"},"ALKiln freezes the versions of its dependencies"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"Just like you can freeze the versions of the ",(0,n.kt)("a",{parentName:"p",href:"#freeze"},"ALKiln framework"),", ALKiln freezes the versions of its own dependencies - the libraries it uses. When we update our dependencies to their latest versions, we check the updates and do our best to make sure that we are comfortable with the changes."),(0,n.kt)("h3",{id:"alkiln-deps"},"ALKiln updates its dependencies"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"The ALKiln team checks on the security of ALKiln's dependencies. When a dependency reports a new security improvement, we update ALKiln to use that new improvement. Not all dependency fixes are relevant to ALKiln, but it is still good to keep up to date."),(0,n.kt)("h3",{id:"alkiln-branches"},"ALKiln protects its major branches"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"ALKiln protects itself from unintended changes or changes by new collaborators. ALKiln has gotten many volunteer contributions over time, and we want to make sure we check that code carefully before we release it to you."),(0,n.kt)("p",null,"As our documentation described, ",(0,n.kt)("a",{parentName:"p",href:"#default-branch"},"you can protect your default branch from changes"),". ALKiln has multiple branches that users depend on - one branch for every major version. For example, v3, v4, and v5. It protects all those branches in various ways. For example, we:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Require contributors to make new branches when they edit code"),(0,n.kt)("li",{parentName:"ul"},"Require contributors to make a pull request before new code can be added to the main branch"),(0,n.kt)("li",{parentName:"ul"},"Require administrators to approve a pull request before that code can be merged so that we have a chance to review it")),(0,n.kt)("p",null,"Our administrators can get past these restrictions. We keep tight control of who our administrators are."),(0,n.kt)("h3",{id:"alkiln-action-files"},"ALKiln uses good action file practices"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for any packages that:")," run tests in GitHub"),(0,n.kt)("p",null,"ALKiln's action files are very similar to workflow files, like yours. As such, they use the same ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions"},"GitHub-recommended practices")," that your workflows can use."),(0,n.kt)("h3",{id:"report"},"You can report an ALKiln security vulnerability"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,n.kt)("p",null,"If you find an ALKiln security vulnerability, you can ",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability#privately-reporting-a-security-vulnerability"},"report it to us privately"),"."),(0,n.kt)("div",{className:"footnotes"},(0,n.kt)("hr",{parentName:"div"}),(0,n.kt)("ol",{parentName:"div"},(0,n.kt)("li",{parentName:"ol",id:"fn-bonus"},"Using a different server for testing is better in other ways, too. When developers pull packages that have python files onto your docassemble server, it reloads for a while. This can cause your clients' interviews to time out. ",(0,n.kt)(s.tD,{mdxType:"GTOYS"})," tests do the same and can make for a slower user experience if they are used on a production server.",(0,n.kt)("a",{parentName:"li",href:"#fnref-bonus",className:"footnote-backref"},"\u21a9")),(0,n.kt)("li",{parentName:"ol",id:"fn-perks"},"There are other good reasons to avoid using an existing developer's account that are not related to security. For one thing, the tests create Projects and run interviews. It may be confusing for an existing developer to find those in their account. For another thing, if you do use a real developer's account and that developer leaves your organization, tests will start failing. It may take you a while to track down the problem and fix it.",(0,n.kt)("a",{parentName:"li",href:"#fnref-perks",className:"footnote-backref"},"\u21a9")),(0,n.kt)("li",{parentName:"ol",id:"fn-org_secrets"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions#creating-secrets-for-an-organization"},"GitHub organization secrets")," can be useful if an organization wants to create a variable that all of its repositories will be able to use and avoid creating that secret in every individual repository.",(0,n.kt)("a",{parentName:"li",href:"#fnref-org_secrets",className:"footnote-backref"},"\u21a9")),(0,n.kt)("li",{parentName:"ol",id:"fn-sha"},'SHA stands for "secure hash algorithm". Git has a secure hash algorithm of its own to make an "id" for each commit that is 40 characters long. Very broadly, for each commit a repository makes, git uses math to reliably turn the whole history of the package and all its versions, including the newest commit, into 40 letters and numbers. Unlike a branch name, no one can edit a commit SHA because it would break the math. A developer can only delete the commit. Because of this, you can pretty much rely on a commit SHA to always go to either the same code or no code at all. That is, no one can hide sneaky new code there.',(0,n.kt)("a",{parentName:"li",href:"#fnref-sha",className:"footnote-backref"},"\u21a9")),(0,n.kt)("li",{parentName:"ol",id:"fn-ish"},"Technically, the same exact version is usually overkill. As long as the action code and the framework code are aligned, they can point to different versions. This simplification is a lot easier to explain, though.",(0,n.kt)("a",{parentName:"li",href:"#fnref-ish",className:"footnote-backref"},"\u21a9")))))}h.isMDXComponent=!0}}]);