"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[6101],{1901:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"admin_guide_docassemble/running-docassemble-without-aws","title":"Running Docassemble without AWS and S3","description":"Motivation","source":"@site/docs/admin_guide_docassemble/running-docassemble-without-aws.md","sourceDirName":"admin_guide_docassemble","slug":"/admin_guide_docassemble/running-without-aws","permalink":"/docs/admin_guide_docassemble/running-without-aws","draft":false,"unlisted":false,"editUrl":"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/admin_guide_docassemble/running-docassemble-without-aws.md","tags":[],"version":"current","frontMatter":{"slug":"running-without-aws","title":"Running Docassemble without AWS and S3","sidebar_label":"Running Docassemble without AWS"},"sidebar":"docs","previous":{"title":"Rebuilding your AWS Lightsail instance","permalink":"/docs/admin_guide_docassemble/rebuild-lightsail-instance"},"next":{"title":"Docassemble with Docker and VS Code","permalink":"/docs/admin_guide_docassemble/run-docassemble-docker-vscode"}}');var t=n(4848),o=n(8453);const r={slug:"running-without-aws",title:"Running Docassemble without AWS and S3",sidebar_label:"Running Docassemble without AWS"},c=void 0,i={},l=[{value:"Motivation",id:"motivation",level:2},{value:"Setup your Domain",id:"setup-your-domain",level:2},{value:"Start the Docassemble server",id:"start-the-docassemble-server",level:2},{value:"Install Docker",id:"install-docker",level:3},{value:"Start Docassemble",id:"start-docassemble",level:3},{value:"Upgrading the Docassemble server",id:"upgrading-the-docassemble-server",level:2},{value:"Saving Backup data",id:"saving-backup-data",level:2},{value:"Restorting Backup data",id:"restorting-backup-data",level:2}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"motivation",children:"Motivation"}),"\n",(0,t.jsxs)(s.p,{children:["In most situations, we recommend that you follow ",(0,t.jsx)(s.a,{href:"setup-server",children:'"Installing a Docassemble Server"'})," and use a hosted\nvirtual server with S3 compatible storage, which will give you more resilient servers and easier backups. If\nfor some reason you need to host all of you servers on premises and cannot use cloud servers, this guide should\nbe helpful."]}),"\n",(0,t.jsx)(s.h2,{id:"setup-your-domain",children:"Setup your Domain"}),"\n",(0,t.jsxs)(s.p,{children:["These are mostly the same steps from ",(0,t.jsx)(s.a,{href:"setup-server#choose-a-dns-name",children:'"Choose a DNS Name"'})," and ",(0,t.jsx)(s.a,{href:"setup-server#create-an-a-record-that-points-to-the-reserved-ip-address-in-your-dns-providers-website",children:"\"Create an 'A' record\""}),". If you are hosting your own servers,\nyou will need to find out what IP address you have and point the 'A' record to that address."]}),"\n",(0,t.jsx)(s.h2,{id:"start-the-docassemble-server",children:"Start the Docassemble server"}),"\n",(0,t.jsx)(s.h3,{id:"install-docker",children:"Install Docker"}),"\n",(0,t.jsxs)(s.p,{children:["Even if you are running Docassemble on your own server, we still recommend that you use Docker\nto run docassemble. As described in ",(0,t.jsx)(s.a,{href:"https://docassemble.org/docs/installation.html#docker",children:"the Docassemble documentation"}),", running Docassemble without Docker is a significantly complicated exercise, with multiple long-running and reoccuring processes, and there are not many benefits that you can get from doing it."]}),"\n",(0,t.jsxs)(s.p,{children:["So, the first step to starting the Docassemble server is to install Docker. This can follow the same steps from ",(0,t.jsx)(s.a,{href:"setup-server#install-docker",children:'"Install Docker"'}),". If you are running on a different OS than linux, you should follow ",(0,t.jsx)(s.a,{href:"https://www.docker.com/get-started/",children:"Docker's official installation instructions"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"start-docassemble",children:"Start Docassemble"}),"\n",(0,t.jsxs)(s.p,{children:["You can first create an ",(0,t.jsx)(s.code,{children:"env.list"})," file, which should contain the following:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-txt",children:"DAHOSTNAME=apps.example.com\nTIMEZONE=America/New_York\nUSEHTTPS=true\nUSELETSENCRYPT=true\nLETSENCRYPTEMAIL=apps@example.com\nDAEXTRAFONTS=false\nDAGOOGLEFONTS=false\n"})}),"\n",(0,t.jsx)(s.p,{children:"Then, you can start Docassemble."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker run -d -p 443:443 -p 80:80 -v dabackup:/usr/share/docassemble/backup --restart unless-stopped --env-file env.list --stop-timeout 600 --name docassemble jhpyle/docassemble\n"})}),"\n",(0,t.jsx)(s.h2,{id:"upgrading-the-docassemble-server",children:"Upgrading the Docassemble server"}),"\n",(0,t.jsxs)(s.p,{children:["The above command (specifically the ",(0,t.jsx)(s.code,{children:"-v"})," argument) created a docker volume that saves all information from the ",(0,t.jsx)(s.code,{children:"/usr/share/docassemble/backup"})," directory somewhere separate from the Docassemble container on your machine. To upgrade to a newer version of the Docassemble container, you can do so without any extra commands handling the data."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker stop -t 600 docassemble\ndocker pull jhpyle/docassemble\ndocker rm docassemble\ndocker run -d -p 443:443 -p 80:80 -v dabackup:/usr/share/docassemble/backup --restart unless-stopped --env-file env.list --stop-timeout 600 --name docassemble jhpyle/docassemble\n"})}),"\n",(0,t.jsx)(s.h2,{id:"saving-backup-data",children:"Saving Backup data"}),"\n",(0,t.jsx)(s.p,{children:"All of the backup information is present in your Docker volume. If you want extra\ncopies of that data to store elsewhere, you can use the following command while the\ncontainer is running."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker cp docassemble:/usr/share/docassemble/backup .\n"})}),"\n",(0,t.jsxs)(s.p,{children:["The resulting directory, ",(0,t.jsx)(s.code,{children:"backup"}),", will have folders named after\neach date when the backup was taken, and the server can be restored from\nat any time."]}),"\n",(0,t.jsx)(s.h2,{id:"restorting-backup-data",children:"Restorting Backup data"}),"\n",(0,t.jsx)(s.p,{children:"If you want to rollback to data from a certain date, first stop the existing\nDocassemble container, and create (but don't start) a new one:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker stop -t 600 docassemble\ndocker pull jhpyle/docassemble\ndocker rm docassemble\ndocker create -p 443:443 -p 80:80 -v dabackup:/usr/share/docassemble/backup --restart unless-stopped --env-file env.list --stop-timeout 600 --name docassemble jhpyle/docassemble\n"})}),"\n",(0,t.jsx)(s.p,{children:"From there, copy the data from one of the dated backup folders into the main backup folder."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Copy locally first: docker can't copy within the container\ndocker cp docassemble:/usr/share/docassemble/backup/11-03 backup\ndocker cp backup docassemble:/usr/share/docassemble\n"})}),"\n",(0,t.jsx)(s.p,{children:"Then start the container."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker start docassemble\n"})})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>c});var a=n(6540);const t={},o=a.createContext(t);function r(e){const s=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(o.Provider,{value:s},e.children)}}}]);