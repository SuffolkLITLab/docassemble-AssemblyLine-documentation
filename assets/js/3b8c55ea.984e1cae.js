"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[3217],{4137:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?a.createElement(h,l(l({ref:t},u),{},{components:n})):a.createElement(h,l({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,l=new Array(i);l[0]=d;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var c=2;c<i;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},335:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var a=n(7462),o=n(3366),i=(n(7294),n(4137)),l=["components"],r={id:"installation",title:"Installing the Assembly Line",sidebar_label:"Installation",slug:"/installation"},s=void 0,c={unversionedId:"installation",id:"installation",title:"Installing the Assembly Line",description:"Before you get started, make sure that you have [installed",source:"@site/docs/installation.md",sourceDirName:".",slug:"/installation",permalink:"/docassemble-AssemblyLine-documentation/docs/installation",editUrl:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/installation.md",tags:[],version:"current",frontMatter:{id:"installation",title:"Installing the Assembly Line",sidebar_label:"Installation",slug:"/installation"},sidebar:"someSidebar",previous:{title:"Step-by-step",permalink:"/docassemble-AssemblyLine-documentation/docs/assembly_line_steps/steps"},next:{title:"AL Project Architecture",permalink:"/docassemble-AssemblyLine-documentation/docs/al_project_architecture"}},u=[{value:"Install ALDashboard",id:"install-aldashboard",children:[],level:2},{value:"Run the installation script",id:"run-the-installation-script",children:[],level:2},{value:"Customize the ALGenericJurisdiction repository",id:"customize-the-algenericjurisdiction-repository",children:[],level:2},{value:"Docker-level server configuration changes we recommend",id:"docker-level-server-configuration-changes-we-recommend",children:[{value:"Increase nginx timeouts to 5 minutes",id:"increase-nginx-timeouts-to-5-minutes",children:[],level:3},{value:"Replace the nginx 504 gateway timeout page",id:"replace-the-nginx-504-gateway-timeout-page",children:[],level:3}],level:2}],p={toc:u};function d(e){var t=e.components,r=(0,o.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Before you get started, make sure that you have ",(0,i.kt)("a",{parentName:"p",href:"https://suffolklitlab.org/legal-tech-class/docs/practical-guide-docassemble/setup-server"},"installed\nDocassemble"),"\non a server that you maintain."),(0,i.kt)("p",null,"Installing the Assembly Line covers the following basic steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Install the docassemble.ALDashboard package"),(0,i.kt)("li",{parentName:"ol"},"Run the installation script"),(0,i.kt)("li",{parentName:"ol"},"Customize and install the\n",(0,i.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/docassemble-ALGenericJurisdiction/"},"ALGenericJurisdiction"),"\npackage with branding and question wording to match your needs."),(0,i.kt)("li",{parentName:"ol"},"Use the Weaver tool to automate your labeled PDF or DOCX forms.")),(0,i.kt)("h2",{id:"install-aldashboard"},"Install ALDashboard"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/docassemble-ALDashboard"},"ALDashboard")," contains\nseveral features, but most importantly, it includes a menu-driven installation\nscript for the Assembly Line."),(0,i.kt)("p",null,"It will help you:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"install all required and optional Assembly Line packages"),(0,i.kt)("li",{parentName:"ol"},"verify and configure short links, configuration changes, and API\nconfigurations")),(0,i.kt)("p",null,"To install ALDashboard:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'visit the "Package Management" menu on your Docassemble server when you are\nlogged in as a server administrator'),(0,i.kt)("li",{parentName:"ol"},"Type ",(0,i.kt)("inlineCode",{parentName:"li"},"docassemble.ALDashboard")," into the input box labeled ",(0,i.kt)("inlineCode",{parentName:"li"},"Package on PyPI"),(0,i.kt)("img",{alt:"Package on PyPI",src:n(4150).Z})),(0,i.kt)("li",{parentName:"ol"},"Click the ",(0,i.kt)("strong",{parentName:"li"},"Update")," button.")),(0,i.kt)("h2",{id:"run-the-installation-script"},"Run the installation script"),(0,i.kt)("p",null,"Once ALDashboard is successfully installed, edit this link to replace\n",(0,i.kt)("inlineCode",{parentName:"p"},"YOUR_SERVER")," with the URL to your own Docassemble server and visit it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"https://YOURSERVER.com/start/ALDashboard/menu\n")),(0,i.kt)("p",null,'Click the icon labeled "Install Assembly Line"'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Install assembly line",src:n(3004).Z})),(0,i.kt)("p",null,"You will be asked to set up multiple APIs during the installation process.\nIf you do not have accounts yet, you can use the default choices for those\nrequests and return to them later."),(0,i.kt)("p",null,"Specifically, you will be asked to setup:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docassemble.org/docs/config.html#google"},"Google Maps, Places, and Google Geocoding APIs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docassemble.org/docs/config.html#voicerss"},"VoiceRSS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docassemble.org/docs/config.html#twilio"},"Twilio SMS")),(0,i.kt)("li",{parentName:"ul"},"an ",(0,i.kt)("a",{parentName:"li",href:"https://docassemble.org/docs/config.html#mail"},"email server")," of your choice (we recommend Sendgrid)")),(0,i.kt)("p",null,"You will also be asked to create a GitHub private access token on a new\nGitHub account. This account should NOT be your primary account as it will\nbe used for automation."),(0,i.kt)("p",null,"Walk through the guided menus to complete the installation. You can safely\ninstall all recommended packages and use all default configuration choices.\nIf you do not know the answer, you can return and manually edit your\nconfiguration later."),(0,i.kt)("h2",{id:"customize-the-algenericjurisdiction-repository"},"Customize the ALGenericJurisdiction repository"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/docassemble-ALGenericJurisdiction/"},"ALGenericJurisdiction"),"\nis a docassemble package that includes an example of how to modify questions and customize\nthem for your own jurisdiction or organization."),(0,i.kt)("p",null,"To use this package, ",(0,i.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/playground.html#packages"},"pull it into your own Docassemble playground"),"."),(0,i.kt)("p",null,"Next, edit the YAML files to fit your own organization's needs. You may also choose to\nadd a custom CSS theme."),(0,i.kt)("p",null,"Now, create a new package from the ",(0,i.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/playground.html#packages"},"Playground packages menu"),".\nSelect the files that you customized and push them to your own Github repository.\nGive the package a meaningful name, like LouisianaSharedBranding."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Copy, do not fork")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is important to copy and create a new package. Do not\nfork the ALGenericJurisdiction package as Docassemble makes it\nchallenging to rename a package."))),(0,i.kt)("h2",{id:"docker-level-server-configuration-changes-we-recommend"},"Docker-level server configuration changes we recommend"),(0,i.kt)("h3",{id:"increase-nginx-timeouts-to-5-minutes"},"Increase nginx timeouts to 5 minutes"),(0,i.kt)("p",null,'Sometimes, long-running Docassemble processes can "timeout." The default\nexperience in Docassemble is to show the server\'s built-in error page,\nwhich can be confusing for your end user.'),(0,i.kt)("p",null,"We recommend that you increase the nginx timeout for uwsgi from 60 seconds\n(default) to 5 minutes to reduce the frequency that users run into this\nugly error screen."),(0,i.kt)("p",null,"Unfortunately, this error page can only be changed by sshing into the\nserver and then entering the docker container."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"SSH to the server running Docker."),(0,i.kt)("li",{parentName:"ol"},"Type ",(0,i.kt)("inlineCode",{parentName:"li"},"docker exec -ti [TAB] /bin/bash")," (literally tap the 'tab' key at the\nindicated point) to get an interactive prompt inside your docker container.")),(0,i.kt)("p",null,"Install a text editor and open the nginx configuration file as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"apt update\napt install nano\nnano /etc/nginx/nginx.conf\n")),(0,i.kt)("p",null,"Add the following exact text to the ",(0,i.kt)("inlineCode",{parentName:"p"},"http")," section: ",(0,i.kt)("inlineCode",{parentName:"p"},"uwsgi_read_timeout 300s;")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Edit uwsgi timeout",src:n(4365).Z})),(0,i.kt)("p",null,"Type CTRL+O, CTRL+W to save and exit the configuration file."),(0,i.kt)("p",null,"Type the following commands to restart the nginx process:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"supervisorctl restart nginx\n")),(0,i.kt)("h3",{id:"replace-the-nginx-504-gateway-timeout-page"},"Replace the nginx 504 gateway timeout page"),(0,i.kt)("p",null,"The default ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx")," timeout screen is a little menacing. It also does not give\nyou an indication that you can refresh the screen to try again, but often that\nlets you get past the timeout. But you can customize it."),(0,i.kt)("p",null,"Here is a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/docassemble-ALToolbox/blob/main/docassemble/ALToolbox/data/static/custom_504.html"},"custom HTML 504 gateway timeout\npage"),"\nthat you could install with your own branding and that you can use to replace\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx"),' default. It adds a "Reload" button that may allow your user to move\npast the error string.'),(0,i.kt)("p",null,"First:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"SSH to the server running Docker."),(0,i.kt)("li",{parentName:"ol"},"Type ",(0,i.kt)("inlineCode",{parentName:"li"},"docker exec -ti [TAB] /bin/bash")," (literally tap the 'tab' key at the\nindicated point) to get an interactive prompt inside your docker container.")),(0,i.kt)("p",null,"Install a text editor:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"apt update\napt install nano\n")),(0,i.kt)("p",null,"Create a directory to store your custom configuration files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mkdir /usr/share/nginx/html/errors\n")),(0,i.kt)("p",null,"Open a new nano editor:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"nano /usr/share/nginx/html/errors/custom_504.html\n")),(0,i.kt)("p",null,"Copy and paste the contents  ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SuffolkLITLab/docassemble-ALToolbox/blob/main/docassemble/ALToolbox/data/static/custom_504.html"},"custom HTML 504 gateway timeout\npage"),"\ninto the open ",(0,i.kt)("inlineCode",{parentName:"p"},"nano")," editor on your server."),(0,i.kt)("p",null,"Type CTRL+O CTRL+W to save and close the editor."),(0,i.kt)("p",null,"Edit the ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx")," configuration file to point to your new custom error page:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"nano /etc/nginx.conf\n")),(0,i.kt)("p",null,"Add this line of code to the configuration file, inside the main ",(0,i.kt)("inlineCode",{parentName:"p"},"server")," ",(0,i.kt)("inlineCode",{parentName:"p"},"{}"),"\nbrackets: ",(0,i.kt)("inlineCode",{parentName:"p"},"error_page 504 /errors/custom_504.html;")),(0,i.kt)("p",null,"Type CTRL+O CTRL+W to save and close the editor."),(0,i.kt)("p",null,"Restart the nginx process:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"supervisorctl restart nginx\n")))}d.isMDXComponent=!0},4365:function(e,t,n){t.Z=n.p+"assets/images/edit_uwsgi_timeout-f817c70239d478813280066d3059a623.png"},3004:function(e,t,n){t.Z=n.p+"assets/images/installation_install_assembly_line-333fd4cc787903d9a88a19bd58df9852.png"},4150:function(e,t,n){t.Z=n.p+"assets/images/installation_package_on_pypi-936cae986b2cb653cc7286c2983e6fb1.png"}}]);