"use strict";(self.webpackChunkdocassemble_assembly_line_documentation=self.webpackChunkdocassemble_assembly_line_documentation||[]).push([[7987],{4137:(e,t,o)=>{o.d(t,{Zo:()=>h,kt:()=>d});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},h=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),p=u(o),m=a,d=p["".concat(l,".").concat(m)]||p[m]||c[m]||r;return o?n.createElement(d,i(i({ref:t},h),{},{components:o})):n.createElement(d,i({ref:t},h))}));function d(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:a,i[1]=s;for(var u=2;u<r;u++)i[u]=o[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},4296:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>h,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>u,toc:()=>p});var n=o(7462),a=(o(7294),o(4137));const r={toc:[]};function i(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},r,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"ALKiln avoids taking pictures or downloading the HTML of pages that use environment variables. ALKiln avoids printing the value of an environment variable anywhere in the report or in the console."),(0,a.kt)("admonition",{type:"danger"},(0,a.kt)("p",{parentName:"admonition"},"Avoid manually taking pictures of pages with sensitive information. It is probably possible to trigger those pictures in Steps you write yourself, but we highly recommend against that.")))}i.isMDXComponent=!0;const s={id:"alkiln_security",title:"Keeping ALKiln test secure",sidebar_label:"WIP Security",slug:"/alkiln/security"},l=void 0,u={unversionedId:"alkiln/alkiln_security",id:"alkiln/alkiln_security",title:"Keeping ALKiln test secure",description:"WIP (Work in progress)",source:"@site/docs/alkiln/security.mdx",sourceDirName:"alkiln",slug:"/alkiln/security",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/security",draft:!1,editUrl:"https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/alkiln/security.mdx",tags:[],version:"current",frontMatter:{id:"alkiln_security",title:"Keeping ALKiln test secure",sidebar_label:"WIP Security",slug:"/alkiln/security"},sidebar:"docs",previous:{title:"WIP Troubleshooting & errors",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/trouble"},next:{title:"WIP Older versions",permalink:"/docassemble-AssemblyLine-documentation/docs/alkiln/old"}},h={},p=[{value:"Use a separate server just for testing",id:"testing-server",level:2},{value:"Disable a single test or test file",id:"disable-test",level:2},{value:"Disable repository tests",id:"disable-repo",level:2},{value:"Disabling tests for the whole organization",id:"disable-org",level:2},{value:"Use GitHub&#39;s recommended workflow practices",id:"workflow",level:2},{value:"Protect your default branch",id:"default-branch",level:2},{value:"Avoid sensitive information in package files",id:"sensitive-info-general",level:2},{value:"Use sensitive information in GitHub tests",id:"sensitive-info-github",level:2},{value:"Freeze the ALKiln framework version",id:"freeze-framework",level:2},{value:"Freeze an ALKiln action version",id:"freeze-actions",level:2},{value:"Isolated server tests",id:"isolated-server",level:2},{value:"Use sensitive information in Playground tests",id:"sensitive-info-playground",level:2},{value:"Things to worry about less",id:"things-to-worry-about-less",level:2},{value:"Worry less: Your production server",id:"production",level:3},{value:"Worry less: GitHub logs and artifacts",id:"github-output",level:3},{value:"Worry less: Pull request triggers",id:"pull-requests",level:3},{value:"Worry less: GitHub redacts secrets",id:"github-redacts-secrets",level:3},{value:"Worry less: ALKilnInThePlayground already freezes your ALKiln version",id:"playground-version",level:3},{value:"ALKiln protects you too",id:"alkilns-precautions",level:2},{value:"Report an ALKiln security vulnerability",id:"report",level:3},{value:"ALKiln avoids printing sensitive information",id:"alkiln-env-vars",level:3},{value:"ALKiln freezes the versions of its dependencies",id:"alkiln-freezes-dependencies",level:3},{value:"ALKiln protects its major branches",id:"alkiln-branches",level:3},{value:"ALKiln uses good action file practices",id:"alkiln-action-files",level:3}],c={toc:p};function m(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("admonition",{type:"warning"},(0,a.kt)("p",{parentName:"admonition"},"WIP (Work in progress)")),(0,a.kt)("p",null,"This page will help you learn some steps you can take to protect yourself and your users as you develop tests with ALKiln. It will also talk about the security practices ALKiln uses."),(0,a.kt)("p",null,"Using a third-party library or package is always a risk. That said, we take measures to help secure our code, such as protecting our release branches and requiring reviews before merging any new code."),(0,a.kt)("p",null,"In addition, here are some actions you can take to manage the security of the tests, as well as general guidelines for server security."),(0,a.kt)("h2",{id:"testing-server"},"Use a separate server just for testing"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,"Keep the testing server completely separate from production server so that the tests never show sensitive information to potential malicious actors."),(0,a.kt)("p",null,"You should:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Avoid running tests on your production server, use the testing server's address in the ",(0,a.kt)("inlineCode",{parentName:"li"},"SERVER_URL")," GitHub secret "),(0,a.kt)("li",{parentName:"ul"},"Avoid installing ALKiln on your production server, avoid installing the ALKilnInThePlayground package on your production server"),(0,a.kt)("li",{parentName:"ul"},"Avoid using a link to a page on your production server in any of your tests")),(0,a.kt)("p",null,"In addition, some general good practices for a testing server are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Never share API keys or passwords between servers"),(0,a.kt)("li",{parentName:"ul"},"Periodically clear out the testing server and start a new docker container from scratch"),(0,a.kt)("li",{parentName:"ul"},"Occasionally check the testing server to make sure it's not running resource stealing code (blockchain miners, etc.)")),(0,a.kt)("p",null,"If you do this, ",(0,a.kt)("a",{parentName:"p",href:"#production"},"the tests will be unable to affect your production server"),"."),(0,a.kt)("h2",{id:"disable-test"},"Disable a single test or test file"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,'To fully disable a test or test file - a file in your "Sources" ending in ',(0,a.kt)("inlineCode",{parentName:"p"},".feature")," - you must edit or delete that file."),(0,a.kt)("p",null,"You can comment out all the code in a test by editing it in your Playground or ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"editing it in GitHub")," to add ",(0,a.kt)("inlineCode",{parentName:"p"},"#")," at the start of every line of the test."),(0,a.kt)("p",null,"You can also comment out every line in a test file."),(0,a.kt)("p",null,"Alternatively, you can ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/deleting-files-in-a-repository"},"delete a test file from your repository completely"),". It is in your sources folder."),(0,a.kt)("h2",{id:"disable-repo"},"Disable repository tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"If you become worried about the tests, there are different ways you can stop the tests from running."),(0,a.kt)("p",null,'In order to run, the test setup interview added a "workflow" file to your repository. GitHub sometimes calls that an "action". That\'s what starts the tests. You can manage that workflow, and your actions in general, in GitHub.'),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/managing-workflow-runs/disabling-and-enabling-a-workflow"},"GitHub lets you disable workflow files")," like the ones you have for running ALKiln tests in your ",(0,a.kt)("inlineCode",{parentName:"p"},".github/workflows")," repository directory."),(0,a.kt)("p",null,"Another option is to disable or limit all tests, or all actions, in your repository. You can read ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#managing-github-actions-permissions-for-your-repository"},"GitHub's documentation for managing repository actions")," for more information."),(0,a.kt)("p",null,"You can also ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/deleting-files-in-a-repository"},"delete the workflow file from your repository completely"),". If you go to the front page of your repository in GitHub, the file is in the ",(0,a.kt)("inlineCode",{parentName:"p"},"workflows")," folder of the ",(0,a.kt)("inlineCode",{parentName:"p"},".github")," folder. It is often called ",(0,a.kt)("inlineCode",{parentName:"p"},"run_form_tests.yml"),"."),(0,a.kt)("h2",{id:"disable-org"},"Disabling tests for the whole organization"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"You can disable ALKiln tests, or any workflows (actions), for a whole organization. GitHub's documentation for managing organization actions is at ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/organizations/managing-organization-settings/disabling-or-limiting-github-actions-for-your-organization#managing-github-actions-permissions-for-your-organization"},"https://docs.github.com/en/organizations/managing-organization-settings/disabling-or-limiting-github-actions-for-your-organization#managing-github-actions-permissions-for-your-organization"),"."),(0,a.kt)("h2",{id:"workflow"},"Use GitHub's recommended workflow practices"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have a repository in GitHub"),(0,a.kt)("p",null,"GitHub has documentation about ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions"},"keeping your GitHub workflows secure"),". We cover some of that content in here, but you can read that documentation for more."),(0,a.kt)("p",null,"You can specifically look at ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-third-party-actions"},"GitHub's recommendations for using third-party actions"),", like the ALKiln actions."),(0,a.kt)("h2",{id:"default-branch"},"Protect your default branch"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have a repository in GitHub"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this you MUST be:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Either the GitHub repository admin or"),(0,a.kt)("li",{parentName:"ul"},"the GitHub organization admin")),(0,a.kt)("p",null,"You can protect your packages from unintended changes or changes by new collaborators by protecting your default branch."),(0,a.kt)("p",null,'Your default branch is usually called "main". That branch usually has the code that you run on your server and that other packages use. For that reason, many packages ',(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches"},"protect their default branch from unexpected changes"),"."),(0,a.kt)("p",null,"For example, you can require that:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Contributors make new branches when they edit code"),(0,a.kt)("li",{parentName:"ul"},"Contributors make a pull request before new code can be added to the main branch"),(0,a.kt)("li",{parentName:"ul"},"Administrators have to approve the pull request before that code can be merged")),(0,a.kt)("p",null,"You can allow administrators to skip these restrictions if you want."),(0,a.kt)("h2",{id:"sensitive-info-general"},"Avoid sensitive information in package files"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have files that can be seen by the public"),(0,a.kt)("p",null,"Avoid putting secure information in files that others can see."),(0,a.kt)("p",null,"If you have a repository on GitHub, avoid putting sensitive information in any of your files, including your test files. Those are the files in your Sources folder that end in ",(0,a.kt)("inlineCode",{parentName:"p"},".feature"),". Also avoid putting sensitive information in your workflow files. Anyone who can see your GitHub repository can see those files and the information in them."),(0,a.kt)("p",null,"If you need to use sensitive information in your tests:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"For tests running in GitHub, ",(0,a.kt)("a",{parentName:"li",href:"#sensitive-info-github"},"add a GitHub secret")),(0,a.kt)("li",{parentName:"ul"},"For ALKilnInThePlayground tests, ",(0,a.kt)("a",{parentName:"li",href:"#sensitive-info-playground"},"add a variable in your docassemble configuration file"))),(0,a.kt)("h2",{id:"sensitive-info-github"},"Use sensitive information in GitHub tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this you MUST be:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Either the GitHub repository admin or"),(0,a.kt)("li",{parentName:"ul"},"the GitHub organization admin")),(0,a.kt)("p",null,"These are the only people that can create GitHub secrets"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this it helps to know about:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"GitHub secrets"),(0,a.kt)("li",{parentName:"ul"},"Workflow environment variables"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"Editing GitHub files"))),(0,a.kt)("p",null,'Sometimes authors do need to pass sensitive information to their tests. For example, some tests require the "user" to log in, so the tests need to know the email and password for that user. In GitHub, you can do this securely by using ',(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets"},"GitHub secrets")," and adding environment variables to your repository's GitHub workflow file. You can also read about ",(0,a.kt)("a",{parentName:"p",href:"#sensitive-info-playground"},"how to use sensitive information with ALKilnInThePlayground tests"),"."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Follow the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets"},"GitHub instructions")," to set one or more GitHub secrets. You can add these to one repository's secrets or you can add these to your organization's secrets",(0,a.kt)("sup",{parentName:"p",id:"fnref-org_secrets"},(0,a.kt)("a",{parentName:"sup",href:"#fn-org_secrets",className:"footnote-ref"},"org_secrets")),", whichever is right for you.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Go to the home page of your repository. Tap on the ",(0,a.kt)("inlineCode",{parentName:"p"},".github")," folder, then on ",(0,a.kt)("inlineCode",{parentName:"p"},"workflows")," folder, then on the YAML file in there that runs the ALKiln tests.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"It should include a line that looks similar to this:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"jobs:\n  alkiln-tests:\n    runs-on: ubuntu-latest\n    name: Run ALKiln tests\n")),(0,a.kt)("p",null,"If this is the first environment variable you're adding, right below that last line add a new line like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"    env:\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Whenever you want to add a secret, add a new line under ",(0,a.kt)("inlineCode",{parentName:"li"},"env:")," indented from ",(0,a.kt)("inlineCode",{parentName:"li"},"env:"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},'      ALKILN_USER_PASSWORD: "${{ secrets.ALKILN_USER_PASSWORD }}"\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ALKILN_USER_PASSWORD")," is just a placeholder in our example. You can name your secrets whatever you want to. Make sure the name here matches your GitHub secret name."),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Write your Step and use the names of these secrets as the values. For example:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-gherkin"},'    And I set the variable "very_secure_password" to "ALKILN_USER_PASSWORD"\n')),(0,a.kt)("p",null,"Your workflow file code will end up including something like the below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},'# Other workflow code\n\njobs:\n  alkiln-tests:\n    runs-on: ubuntu-latest\n    name: Run ALKiln tests\n    env:\n      ALKILN_USER_PASSWORD: "${{ secrets.ALKILN_USER_PASSWORD }}"\n\n# Other workflow code\n')),(0,a.kt)("p",null,'We recommend that you start your environment variable names with "ALKILN_". That will help avoid conflicting with the environment variables of your operating system.'),(0,a.kt)(i,{mdxType:"SecureEnvVars"}),(0,a.kt)("p",null,"Right now Story Tables are unable to use environment variables to set variables."),(0,a.kt)("h2",{id:"freeze-framework"},"Freeze the ALKiln framework version"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this it helps to know about:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"Editing GitHub files")),(0,a.kt)("li",{parentName:"ul"},"GitHub workflow files"),(0,a.kt)("li",{parentName:"ul"},"GitHub action inputs"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.npmjs.com/about-semantic-versioning"},"node versions"))),(0,a.kt)("p",null,"The ALKiln framework lets you control the robot that goes through your interview answering questions. This is different from the ALKiln actions, which trigger GitHub to start your tests."),(0,a.kt)("p",null,"The workflow file we first create for you in the ALKiln setup interview always uses the latest major version",(0,a.kt)("sup",{parentName:"p",id:"fnref-versions"},(0,a.kt)("a",{parentName:"sup",href:"#fn-versions",className:"footnote-ref"},"versions"))," of the ALKiln framework. That major version is based on when you used the setup interview. As of March 2024, ALKiln is on major version 5. Tests that authors set up now will use the latest version 5 code. For example, version ",(0,a.kt)("inlineCode",{parentName:"p"},"5.10.1")," as of March 12, 2024."),(0,a.kt)("p",null,"This means that the ALKiln framework you are using has all the latest bug fixes and new features. That can be a good thing, but it also means you might not be sure of exactly what code runs your tests."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#alkilns-precautions"},"ALKiln itself already uses practices that protect you from malicious actors"),". There is a way to make sure to always use an exact version of the ALKiln framework, though, if you want. You can use a version that has code and behavior that you are familiar with and feel comfortable with."),(0,a.kt)("p",null,'To "freeze" your ALKiln framework version in this way, you can reference a ',(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@suffolklitlab/alkiln?activeTab=versions"},"specific ALKiln package version")," in your workflow "," file. Go to the code in your workflow file that looks similar to the below and add the ",(0,a.kt)("inlineCode",{parentName:"p"},"ALKILN_VERSION")," input variable that you see here:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},'        uses: SuffolkLITLab/ALKiln@v5\n        with:\n          SERVER_URL: "${{ secrets.SERVER_URL }}"\n          DOCASSEMBLE_DEVELOPER_API_KEY: "${{ secrets.DOCASSEMBLE_DEVELOPER_API_KEY }}"\n          ALKILN_VERSION: "5.9.0"\n')),(0,a.kt)("p",null,'Instead of "5.9.0", write the version you want to use.'),(0,a.kt)("p",null,"When you want to update to a new version of the framework, you can check all the new changes to the code to make sure you feel comfortable with them before updating to a new node version."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"This is different than ",(0,a.kt)("a",{parentName:"p",href:"#freeze-actions"},"the ALKiln action versions"),". The ALKiln actions let you start your tests on GitHub. You do usually need to make sure these match, though, as they work together. When you update one, you should also update the other.")),(0,a.kt)("h2",{id:"freeze-actions"},"Freeze an ALKiln action version"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this it helps to know about:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.github.com/en/repositories/working-with-files/managing-files/editing-files"},"Editing GitHub files")),(0,a.kt)("li",{parentName:"ul"},"GitHub workflow files"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/about-commits#about-commits"},"Git commit ids")," (usually called the commit sha or hash)")),(0,a.kt)("p",null,"ALKiln's actions let your workflow file "," trigger GitHub to start your tests. This is different from the actual ALKiln framework, which lets you control the robot that goes through your interview answering questions."),(0,a.kt)("p",null,'The workflow file we first create for you in the ALKiln setup interview always uses the latest ALKiln action code. As of March 2024, the setup interview uses the latest code of a branch on ALKiln called "v5" for its actions.'),(0,a.kt)("p",null,"This means that your ALKiln action has all the latest bug fixes and new features to the actions. That can be a good thing, but it also means you might not be sure of exactly what code starts your tests."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#alkilns-precautions"},"ALKiln itself already uses practices that protect you from malicious actors"),". There is a way to make sure to always use an exact version of ALKiln's actions, though, if you want. You can use a version that has code and behavior that you are familiar with and feel comfortable with."),(0,a.kt)("p",null,'To "freeze" your ALKiln action version in this way, you can reference a specific ALKiln git commit sha in your workflow file. When you want to update to a new version of the action code, you can check all the new changes to the code to make sure you feel comfortable with them before updating to a new commit sha.'),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/ALKiln"},"ALKiln's repository"),". For example, for the v4 branch, you can go to ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/ALKiln/commits/releases/v5"},"https://github.com/SuffolkLITLab/ALKiln/commits/releases/v5"),"."),(0,a.kt)("li",{parentName:"ol"},"Find the sha of a commit you need. You need the full commit sha. To do that, go to the main page of ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/SuffolkLITLab/ALKiln"},"ALKiln's GitHub repo"),'. Pick the branch of ALKiln that is relevant to you. Near the top, click on \u201ccommits". Find the commit that you want. On the right-hand side of that row will be the shortened version of the commit sha. To the right of that is the \u201ccopy\u201d button. Click that to copy the full commit sha.'),(0,a.kt)("li",{parentName:"ol"},"In your repository's directory, go to .github/workflows and find the file that starts the tests. There's a line in there that look's something like this:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"uses: suffolkLITLab/ALKiln@releases/v5\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},'Change the text "releases/v5" to the commit sha.')),(0,a.kt)("p",null,"When you want to update to a new version of an ALKiln action, update that sha manually."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"This is different than the ",(0,a.kt)("a",{parentName:"p",href:"#freeze-framework"},"ALKiln framework version"),". The framework does more than just start your tests. It is the code that lets you control the robot that goes through your interview answering questions. You do usually need to make sure these match, though, as they work together. When you update one, you should also update the other.")),(0,a.kt)("h2",{id:"isolated-server"},"Isolated server tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have isolated server tests that run in GitHub"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/docassemble-AssemblyLine-documentation/docs/alkiln/setup#isolated-server-how"},"Isolated server tests")," are useful for security if you use them correctly."),(0,a.kt)("p",null,"For example, you have to avoid using hard-coded urls that are on your server. That is, avoid using ",(0,a.kt)("inlineCode",{parentName:"p"},"https://my-server.com")," and interviews or other pages there. That will send the tests to your server, which goes around all these precautions and makes them less secure again."),(0,a.kt)("h2",{id:"sensitive-info-playground"},"Use sensitive information in Playground tests"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," you test with ALKilnInThePlayground"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"To do this you MUST be able to:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Edit your server's config file")),(0,a.kt)("p",null,'Sometimes authors do need to pass sensitive information to their tests. For example, some tests require the "user" to log in, so the tests need to know the email and password for that user. You can do this securely in your ALKilnInThePlayground tests by adding this information to your docassemble server configuration file. ALKiln will use these as environment variables for your tests.'),(0,a.kt)("p",null,"You can also read about ",(0,a.kt)("a",{parentName:"p",href:"#sensitive-info-github"},"how to use sensitive information in GitHub tests"),"."),(0,a.kt)("p",null,"To do this, ",(0,a.kt)("a",{parentName:"p",href:"https://docassemble.org/docs/config.html#edit"},"edit your docassemble server's configuration file")," to add your environment variables under the ",(0,a.kt)("inlineCode",{parentName:"p"},"alkiln")," key. For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"# Other config values\nalkiln:\n  ALKILN_USER_PASSWORD: 123password\n")),(0,a.kt)("p",null,"The use that environment variable name in your test. For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-gherkin"},'    And I set the variable "very_secure_password" to "ALKILN_USER_PASSWORD"\n')),(0,a.kt)("p",null,'We recommend that you start your environment variable names with "ALKILN_". That will help avoid conflicting with the environment variables of your operating system.'),(0,a.kt)(i,{mdxType:"SecureEnvVars"}),(0,a.kt)("p",null,"Right now Story Tables are unable to use environment variables to set variables."),(0,a.kt)("h2",{id:"things-to-worry-about-less"},"Things to worry about less"),(0,a.kt)("p",null,"There are some security protections that you have automatically."),(0,a.kt)("h3",{id:"production"},"Worry less: Your production server"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,"As long as you ensure you ",(0,a.kt)("a",{parentName:"p",href:"#testing-server"},"only test on your testing server"),", ALKiln cannot affect your production server."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("inlineCode",{parentName:"li"},".feature"),' files that you have in your "Sources" folder do nothing by themselves. They are as safe as text files.'),(0,a.kt)("li",{parentName:"ul"},"The GitHub workflow files can only run on GitHub.")),(0,a.kt)("h3",{id:"github-output"},"Worry less: GitHub logs and artifacts"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"There are some parts of testing that might look less secure than they are."),(0,a.kt)("p",null,'When you run the tests in GitHub, you can see the logs of the test action\'s job and you can download the results of the test, or "artifacts". That may seem very exposed, but only people who have permissions on the repository, like administrators, collaborators, or moderators, can see or download that information.'),(0,a.kt)("p",null,"If you are still worried about the logs and artifacts in GitHub, ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/using-workflow-run-logs#deleting-logs"},"you can delete the logs")," and ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/managing-workflow-runs/removing-workflow-artifacts"},"you can delete the artifacts"),"."),(0,a.kt)(i,{mdxType:"SecureEnvVars"}),(0,a.kt)("h3",{id:"pull-requests"},"Worry less: Pull request triggers"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"By default, the ALKiln setup interview writes your GitHub workflow file so that your tests will get triggered when you commit to GitHub. You can also add code "," to trigger tests when someone makes a pull request on GitHub."),(0,a.kt)("p",null,"Some people worry that strangers will then be able to trigger workflows that have malicious code. GitHub has default settings that prevent that from happening. They require you to ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/managing-workflow-runs/approving-workflow-runs-from-public-forks"},"approve workflow runs")," triggered by pull requests from first-time contributors. You can read more about these settings ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#controlling-changes-from-forks-to-workflows-in-public-repositories"},"for public repositories")," and ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/organizations/managing-organization-settings/disabling-or-limiting-github-actions-for-your-organization#configuring-required-approval-for-workflows-from-public-forks"},"for organizations"),". The same is true of private repositories. Note that approving workflow runs from first-time contributors to private repositories ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#enabling-workflows-for-forks-of-private-repositories"},"is a bit different"),"."),(0,a.kt)("h3",{id:"github-redacts-secrets"},"Worry less: GitHub redacts secrets"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"In your GitHub ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/using-workflows/about-workflows?learn=getting_started#viewing-the-activity-for-a-workflow-run"},"workflow run console"),', GitHub redacts any text that matches the values of any of your GitHub secrets. It replaces that text with "',"*","*","*",'". It must be an exact match. GitHub is unable to recognize partial matches.'),(0,a.kt)("h3",{id:"playground-version"},"Worry less: ALKilnInThePlayground already freezes your ALKiln version"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," you test with ALKilnInThePlayground"),(0,a.kt)("p",null,"The ALKiln framework lets you control the robot that goes through your interview answering questions. This documentation has already discussed how ",(0,a.kt)("a",{parentName:"p",href:"#freeze-framework"},"you can freeze your ALKiln framework version on GitHub"),"."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#alkilns-precautions"},"ALKiln itself already uses practices that protect you from malicious actors"),". If you want to take extra precautions, though, freezing the version you are using with ALKilnInThePlayground tests does give you more control over what code you are installing on your server and using to run your tests."),(0,a.kt)("p",null,"The first page of the ALKilnInThePlayground lets you choose "," the exact version of ALKiln that runs your tests. You can upgrade or downgrade at any time."),(0,a.kt)("h2",{id:"alkilns-precautions"},"ALKiln protects you too"),(0,a.kt)("p",null,"Out team takes special precautions with ALKiln's code to ensure you are as safe as we can make you. We are always looking for more ways to increase our security."),(0,a.kt)("h3",{id:"report"},"Report an ALKiln security vulnerability"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,"If you find an ALKiln security vulnerability, you can ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability#privately-reporting-a-security-vulnerability"},"report it to us privately"),"."),(0,a.kt)("h3",{id:"alkiln-env-vars"},"ALKiln avoids printing sensitive information"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#sensitive-info-playground"},"Environment variables might contain sensitive information"),". Because of this ALKiln takes extra care with them."),(0,a.kt)(i,{mdxType:"SecureEnvVars"}),(0,a.kt)("h3",{id:"alkiln-freezes-dependencies"},"ALKiln freezes the versions of its dependencies"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,"Just like you can freeze the versions of the ",(0,a.kt)("a",{parentName:"p",href:"#freeze-framework"},"ALKiln framework")," and ",(0,a.kt)("a",{parentName:"p",href:"#freeze-actions"},"ALKiln actions"),", ALKiln freezes the versions of its own dependencies - the libraries it uses. When we update our dependencies to their latest versions, we check the updates and do our best to make sure that we are comfortable with the changes."),(0,a.kt)("h3",{id:"alkiln-branches"},"ALKiln protects its major branches"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for:")," Everyone"),(0,a.kt)("p",null,"ALKiln protects itself from unintended changes or changes by new collaborators. ALKiln has gotten many volunteer contributions over time and we want to make sure we check that code carefully before we release it to you."),(0,a.kt)("p",null,"As our documentation described, ",(0,a.kt)("a",{parentName:"p",href:"#default-branch"},"you can protect your default branch from changes"),". ALKiln has multiple branches that users depend on - one branch for every major version. For example, v3, v4, and v5. It protects all those branches in various ways. For example, we:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Require contributors to make new branches when they edit code"),(0,a.kt)("li",{parentName:"ul"},"Require contributors to make a pull request before new code can be added to the main branch"),(0,a.kt)("li",{parentName:"ul"},"Require administrators to approve a pull request before that code can be merged so that we have a chance to review it.")),(0,a.kt)("p",null,"Our administrators can get past these restrictions. We keep tight control of who our administrators are."),(0,a.kt)("h3",{id:"alkiln-action-files"},"ALKiln uses good action file practices"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is for any packages that:")," have GitHub tests"),(0,a.kt)("p",null,"ALKiln's action files are very similar to workflow files, like yours. As such, they use the same ",(0,a.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions"},"GitHub-recommended practices")," that your workflows can use."),(0,a.kt)("div",{className:"footnotes"},(0,a.kt)("hr",{parentName:"div"}),(0,a.kt)("ol",{parentName:"div"},(0,a.kt)("li",{parentName:"ol",id:"fn-org_secrets"},(0,a.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions#creating-secrets-for-an-organization"},"GitHub organization secrets")," can be useful if an organization wants to create a variable that all of its repositories will be able to use and avoid creating that secret in every individual repository.",(0,a.kt)("a",{parentName:"li",href:"#fnref-org_secrets",className:"footnote-backref"},"\u21a9")),(0,a.kt)("li",{parentName:"ol",id:"fn-versions"},"ALKiln does its best to use ",(0,a.kt)("a",{parentName:"li",href:"https://semver.org/spec/v2.0.0.html"},"semantic versioning"),".",(0,a.kt)("a",{parentName:"li",href:"#fnref-versions",className:"footnote-backref"},"\u21a9")))))}m.isMDXComponent=!0}}]);