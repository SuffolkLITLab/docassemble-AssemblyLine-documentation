<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-authoring/docx_templates" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Working with DOCX files | Document Assembly Line</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://assemblyline.suffolklitlab.org/docs/authoring/docx"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Working with DOCX files | Document Assembly Line"><meta data-rh="true" name="description" content="If strict layout and matching the original page count are important, consider whether to use a PDF template instead."><meta data-rh="true" property="og:description" content="If strict layout and matching the original page count are important, consider whether to use a PDF template instead."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://assemblyline.suffolklitlab.org/docs/authoring/docx"><link data-rh="true" rel="alternate" href="https://assemblyline.suffolklitlab.org/docs/authoring/docx" hreflang="en"><link data-rh="true" rel="alternate" href="https://assemblyline.suffolklitlab.org/docs/authoring/docx" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Working with DOCX files","item":"https://assemblyline.suffolklitlab.org/docs/authoring/docx"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-622Z2D6Q3Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-622Z2D6Q3Q",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.d69c202a.css">
<script src="/assets/js/runtime~main.9bab5b49.js" defer="defer"></script>
<script src="/assets/js/main.956c6d18.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/lit-lab-logo-small-inverted.svg" alt="The Suffolk LIT Lab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/lit-lab-logo-small-inverted.svg" alt="The Suffolk LIT Lab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Document Assembly Line</b></a><a class="navbar__item navbar__link" href="/docs/get_started">Get started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/overview">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://suffolklitlab.org/legal-tech-class/docs/introduction-to-docassemble" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Legal tech class<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://docassemble.org/docs.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docassemble docs<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/SuffolkLITLab/docassemble-AssemblyLine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/authoring/pdfs">Authoring interviews</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/pdfs">Working with PDF files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/authoring/docx">Working with DOCX files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/dynamic_phrasing_based_on_values">Dynamic phrasing based on values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/label_variables">Field labels to use in template files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/naming">Name formats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/generating_code">&quot;Weaving&quot; your form into a draft interview
</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/github">Using GitHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/customizing_interview">Editing your interview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/review_screen">Review Screen
</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/authoring/generated_yaml">Appendix: Understanding the YAML code
</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/style_guide/question_overview">Writing good questions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/coding_style/overview">Coding style guide</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item sidebar-heading">Assembly Line components</li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/AssemblyLine/ALGeneral/overview">AssemblyLine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/ALRecipes/overview">ALRecipes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/ALToolbox/overview">ALToolbox</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/ALThemeTemplate/overview">Customizing look and feel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/RateMyPDF/overview">RateMyPDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/GithubFeedbackForm/overview">GithubFeedbackForm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/InterviewStats/overview">InterviewStats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/components/ALDashboard/overview">About ALDashboard</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/ALDashboard/">ALDashboard modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/FormFyxer/lit_explorer">FormFyxer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/EFSPIntegration/overview">E-filing integration (EFSP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/components/ALKiln/intro">Automated testing (ALKiln)</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Authoring interviews</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Working with DOCX files</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Working with DOCX files</h1></header><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If strict layout and matching the original page count are important, consider whether to use a PDF template instead.</p><p><strong>Reasons to use DOCX:</strong></p><ul>
<li>DOCX documents will grow or shrink to accommodate as much or as little information as the user provides</li>
<li>DOCX documents allow you to use lists and repeated groups naturally and with little extra effort after labeling the first item</li>
<li>DOCX documents allow you to easily make whole sections of a document contingent</li>
<li>DOCX documents work well with linear content that is read by scanning down the page, not across</li>
</ul><p><strong>Reasons to avoid DOCX:</strong></p><ul>
<li>DOCX documents do not work as well for content formatted in columns or that require precise layout</li>
<li>DOCX document content may flow unexpectedly if it is longer than expected</li>
</ul></div></div>
<p>DOCX templates can be edited in any editor that is able to edit DOCX files, including:</p>
<ul>
<li>Microsoft Word, or Microsoft Word Online</li>
<li><a href="https://www.libreoffice.org/" target="_blank" rel="noopener noreferrer">Libre Office</a></li>
<li>Google Docs</li>
</ul>
<p>We recommend using Microsoft Word as your editor when possible if the document
may need additional editing by the user.</p>
<p>If your document will be converted into a PDF for the user, it may be useful to open the
DOCX file in Libre Office. Docassemble, by default, uses Libre Office to convert the Word
file to PDF. Sometimes formatting glitches will be visible only when the document is opened in Libre Office.</p>
<p>DOCX files can be very simple to work with, but we&#x27;ve taken the time to describe some common tasks,
such as working with tables and lists, in more detail here. You have much more control over those
features in a DOCX template than you do in a PDF.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docx-field-labels-are-just-typed-in">DOCX field labels are just typed in<a href="#docx-field-labels-are-just-typed-in" class="hash-link" aria-label="Direct link to DOCX field labels are just typed in" title="Direct link to DOCX field labels are just typed in">​</a></h2>
<p>Fields are added to DOCX templates simply by typing the variable name in the body of your
Microsoft Word document, surrounded by two sets of curly braces, like: <code>{{ variable_name }}</code>.</p>
<p>The syntax to type in fields in a DOCX template is named <code>jinja2</code>.</p>
<p><a href="https://suffolklitlab.org/legal-tech-class/docs/jinja2" target="_blank" rel="noopener noreferrer">Learn more about Jinja2</a>
and about <a href="https://docassemble.org/docs/documents.html#docx%20template%20file" target="_blank" rel="noopener noreferrer">DOCX templates in Docassemble</a>.</p>
<p>The most common kinds of fields you will use again and again
are:</p>
<ol>
<li>Fill in the blank fields, which are simply surrounded with double curly brackets: <code>{{ field_name }}</code></li>
<li>Conditional text with <code>{% if some_condition %}</code> and <code>{% endif %}</code>, or the slight variation <code>{%p if some_condition %} ... {%p endif %}</code> to make a whole paragraph conditional.</li>
</ol>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Docassemble uses the <a href="https://docxtpl.readthedocs.io/en/latest/#jinja2-like-syntax" target="_blank" rel="noopener noreferrer">docxtpl</a> variant of Jinja2</div><div class="admonitionContent_BuS1"><p>docxtpl has slight differences to the more
common Jinja2 format used in HTML documents. If a feature isn&#x27;t working as
you expect, make sure to check the <a href="https://docxtpl.readthedocs.io/en/latest/#jinja2-like-syntax" target="_blank" rel="noopener noreferrer">docxtpl documentation</a>.</p></div></div>
<p>Here is an example of a DOCX template:</p>
<div class="language-jinja2 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja2 codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ other_parties[0].address_block() }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dear {{ other_parties[0] }}:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I am writing today because my {{ house_or_apartment }} is not up to code.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Specifically,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* {%p for item in problems %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* {{ item }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* {%p endfor %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p if previously_notified %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I already told you about this problem on {{ notification_date.format(&quot;MM/dd/yyyy&quot;) }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endif %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please solve this problem promptly.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Yours,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ users[0].signature_if_final(i) }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ users[0] }}</span><br></span></code></pre></div></div>
<h3></h3>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="start-by-just-adding-the-basic-variables-in-your-docx-template-without-repeated-elements-or-advanced-code">Start by just adding the basic variables in your DOCX template, without repeated elements or advanced code<a href="#start-by-just-adding-the-basic-variables-in-your-docx-template-without-repeated-elements-or-advanced-code" class="hash-link" aria-label="Direct link to Start by just adding the basic variables in your DOCX template, without repeated elements or advanced code" title="Direct link to Start by just adding the basic variables in your DOCX template, without repeated elements or advanced code">​</a></h2>
<p>Before you run your form through the Weaver, start out with simple logic.
For example:</p>
<ul>
<li>wait to add <code>for</code> loops that print out each item in a list</li>
<li>avoid using custom methods in variable names, other than the ones listed on
the <a href="/docs/authoring/label_variables">Field labels to use in template files</a> page.</li>
</ul>
<p>The Weaver may not know how to properly handle some more advanced formatting if
you add it before you upload it to the Weaver. You can add these refining details
after you run the form through the Weaver. Use the first draft just to add placeholders
where information will go.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-the-assembly-lines-standard-field-names-for-docx-templates">Use the Assembly Line&#x27;s standard field names for DOCX templates<a href="#use-the-assembly-lines-standard-field-names-for-docx-templates" class="hash-link" aria-label="Direct link to Use the Assembly Line&#x27;s standard field names for DOCX templates" title="Direct link to Use the Assembly Line&#x27;s standard field names for DOCX templates">​</a></h2>
<p>Use the <a href="/docs/authoring/label_variables">specific names for labels</a> for full
compatibility with the Assembly Line framework.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-a-space-before-and-after-the-variable-name-in-the-field-statements">Use a space before and after the variable name in the field statements<a href="#use-a-space-before-and-after-the-variable-name-in-the-field-statements" class="hash-link" aria-label="Direct link to Use a space before and after the variable name in the field statements" title="Direct link to Use a space before and after the variable name in the field statements">​</a></h2>
<p>It&#x27;s best to always use a space before and after the field name or conditional
instruction when using Jinja2 in a DOCX.</p>
<p>A few letters that can be typed directly after the <code>{{</code> or <code>{%</code> characters have
special meaning. Specifically:</p>
<ul>
<li><code>r</code>, which means to treat the field as &quot;raw&quot; formatted DOCX run</li>
<li><code>p</code>, which means to remove the paragraph that the statement is in, and potentially replace with a new, preformatted paragraph</li>
<li><code>tr</code>, same as <code>p</code> but for table rows</li>
<li><code>tc</code>, same as <code>p</code> but for table columns</li>
</ul>
<p>Always using a space helps avoid you forgetting these special cases. It also helps with readability.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-whitespace-and-conditional-text">Dealing with whitespace and conditional text<a href="#dealing-with-whitespace-and-conditional-text" class="hash-link" aria-label="Direct link to Dealing with whitespace and conditional text" title="Direct link to Dealing with whitespace and conditional text">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Avoid using <code>-</code> to control whitespace</div><div class="admonitionContent_BuS1"><p>While in standard Jinja2 you can use a <code>-</code> to control whitespace, this won&#x27;t
work reliably in Docassemble. That is because Docassemble uses <a href="https://docxtpl.readthedocs.io/en/latest/#jinja2-like-syntax" target="_blank" rel="noopener noreferrer">docxtpl</a>, not the standard Jinja2.</p><p>Avoid using this feature in your templates.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-p--and-tr--to-control-white-space-at-the-paragraph-level">Use <code>{%p %}</code> and <code>{%tr %}</code> to control white space at the paragraph level<a href="#use-p--and-tr--to-control-white-space-at-the-paragraph-level" class="hash-link" aria-label="Direct link to use-p--and-tr--to-control-white-space-at-the-paragraph-level" title="Direct link to use-p--and-tr--to-control-white-space-at-the-paragraph-level">​</a></h3>
<p>When inserting conditional paragraphs, make sure that they are wrapped in <code>{%p %}</code> tags, like this:</p>
<div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p if some_condition %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This is my conditional paragraph.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endif %}</span><br></span></code></pre></div></div>
<p>But make sure that the <code>{%p %}</code> is truly in its own paragraph,
not just a soft carriage return. You can check by toggling the <a href="https://support.microsoft.com/en-us/office/turn-formatting-marks-on-or-off-b166e811-d762-4f24-8328-d897cdace459" target="_blank" rel="noopener noreferrer">show formatting marks</a> option in Word.</p>
<p>Also use <code>{%p if %}</code> to control conditional items in a list, like this:</p>
<ol>
<li><code>{%p if condition %}</code></li>
<li>Conditional text</li>
<li><code>{%p endif %}</code></li>
</ol>
<p>Keep the condition inside the list itself. Avoid using the condition in its own
paragraph, as when Docassemble merges the two lists they may behave unpredictably.</p>
<p>Similarly, use <code>tc</code> and <code>tr</code> to control repeated or conditional rows.
Keep this in-line in one table when it makes sense. Avoid using <code>{%p %}</code> and multiple tables, as this can lead to unexpected table formatting when the two
separate tables are merged.</p>
<p>For example, to repeat rows in a table:</p>
<table><thead><tr><th>Attribute 1</th><th>Attribute 2</th></tr></thead><tbody><tr><td><code>{%tr for item in my_list %}</code></td><td> </td></tr><tr><td><code>{{ item.attribute_1 }}</code></td><td><code>{{ item.attribute_2 }}</code></td></tr><tr><td><code>{%tr endfor %}</code></td><td> </td></tr></tbody></table>
<p>The same <code>{%tr %}</code> can be used for conditional rows, and <code>{%tc %}</code> works
similarly for conditional or repeated columns.</p>
<p><code>{%tr %}</code> and <code>{%tc %}</code> should always be in their own row or column.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Don&#x27;t use <code>{%p %}</code> inside a table cell</div><div class="admonitionContent_BuS1"><p><code>{%p %}</code> can lead to unexpected results inside a table. Use <code>{%tr %}</code> instead.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use--if--for-conditional-text-inside-a-single-paragraph">Use <code>{% if %}</code> for conditional text inside a single paragraph<a href="#use--if--for-conditional-text-inside-a-single-paragraph" class="hash-link" aria-label="Direct link to use--if--for-conditional-text-inside-a-single-paragraph" title="Direct link to use--if--for-conditional-text-inside-a-single-paragraph">​</a></h3>
<p>If you have a few conditional words in a paragraph, you can use <code>{% if %}</code>
in-line in the paragraph. For example:</p>
<p><code>{%if user == &quot;self&quot; %}I request{% else %}{{ user }} requests{% endif %} the following:</code></p>
<p>If you have many repeated examples of the same condition, though, you may be
better off making the whole paragraph conditional.</p>
<p>When using in-line conditions, make sure you consistently place the space across
each condition.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-output_checkbox-for-conditional-checkbox-fields-that-look-like-paper-forms">Use <code>output_checkbox()</code> for conditional checkbox fields that look like paper forms<a href="#use-output_checkbox-for-conditional-checkbox-fields-that-look-like-paper-forms" class="hash-link" aria-label="Direct link to use-output_checkbox-for-conditional-checkbox-fields-that-look-like-paper-forms" title="Direct link to use-output_checkbox-for-conditional-checkbox-fields-that-look-like-paper-forms">​</a></h3>
<p>In some cases, you need to make your Word Document look like a document that was
filled in by hand. <a href="/docs/components/ALToolbox/overview#shorthand-function-to-display-a-checkbox-in-replace-of-a-truefalse-boolean-value-in-a-docx-template"><code>output_checkbox()</code></a> can be used to add a checkbox in-line in your document.</p>
<p>These two expressions are equivalent, but the second version takes substantially less
space in your template:</p>
<table><thead><tr><th>Using if/else/endif</th><th>Using output_checkbox()</th></tr></thead><tbody><tr><td><code>{%if condition %}[X]{% else %}[  ]{% endif %}</code></td><td><code>{{ output_checkbox(condition) }}</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="changing-the-appearance-of-inserted-variable-text">Changing the appearance of inserted variable text<a href="#changing-the-appearance-of-inserted-variable-text" class="hash-link" aria-label="Direct link to Changing the appearance of inserted variable text" title="Direct link to Changing the appearance of inserted variable text">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="start-with-microsoft-words-formatting-for-simple-use-cases">Start with Microsoft Word&#x27;s formatting for simple use cases<a href="#start-with-microsoft-words-formatting-for-simple-use-cases" class="hash-link" aria-label="Direct link to Start with Microsoft Word&#x27;s formatting for simple use cases" title="Direct link to Start with Microsoft Word&#x27;s formatting for simple use cases">​</a></h3>
<p>In general, to control the color, italicization, bold, and other features
of the text, you can use Microsoft Word&#x27;s built-in functionality.</p>
<p>Make sure that the bold formatting, etc., is applied to the whole label, including the starting and ending <code>{{ }}</code>.</p>
<p>Example:</p>
<p>This is an inline formatted <em>{{ variable }}</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-filters-functions-and-methods-for-advanced-changes-to-variables">Use filters, functions, and methods for advanced changes to variables<a href="#use-filters-functions-and-methods-for-advanced-changes-to-variables" class="hash-link" aria-label="Direct link to Use filters, functions, and methods for advanced changes to variables" title="Direct link to Use filters, functions, and methods for advanced changes to variables">​</a></h3>
<p>For more advanced changes to the variable text, you will use a mix of
Python functions, methods, and Jinja2 filters. It&#x27;s not always intuitive which
to use when. In some cases, you can use more than one.</p>
<p>Functions and methods are either built-in to Python, Docassemble, or a custom class you create. Note that some Python functions won&#x27;t work in a DOCX template.
If you run into a function that doesn&#x27;t work as expected, look to see if there&#x27;s
an equivalent filter to replace it. In most cases there will be.</p>
<p>This is a function, which surrounds the variable name in <code>()</code>:</p>
<p><code>{{ function_wrapper(some_variable, optional_parameter) }}</code></p>
<p>This is a method:</p>
<p><code>{{ some_variable.method(optional_parameter) }}</code></p>
<p>This is a filter:</p>
<p><code>{{ some_variable | filter }}</code></p>
<p>This is a filter with a parameter:</p>
<p><code>{{ some_variable | filter(optional_parameter) }}</code></p>
<p>Some sources for filters you can use:</p>
<ul>
<li><a href="https://docassemble.org/docs/documents.html#filters" target="_blank" rel="noopener noreferrer">Docassemble-provided Jinja2 filters</a></li>
<li><a href="https://jinja.palletsprojects.com/en/2.11.x/templates/#builtin-filters" target="_blank" rel="noopener noreferrer">List of built-in Jinja2 filters</a> (but note this easier to read, <a href="https://tedboy.github.io/jinja2/templ14.html" target="_blank" rel="noopener noreferrer">unofficial version of this same list</a>)</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>One filter you&#x27;ll find yourself using frequently is the <code>length</code> filter. Docassemble doesn&#x27;t make <code>len()</code> available
inside of Docassemble templates, so you must use <code>length</code> as a filter instead. For example:</p><div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p if users | length &gt; 2 %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endif %}</span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-jinja2-filters-to-change-capitalization">Use Jinja2 filters to change capitalization<a href="#use-jinja2-filters-to-change-capitalization" class="hash-link" aria-label="Direct link to Use Jinja2 filters to change capitalization" title="Direct link to Use Jinja2 filters to change capitalization">​</a></h3>
<p>To change the capitalization of text, it&#x27;s best to use a Jinja2 filter.
If you used Word&#x27;s formatting instead, it would be harder to check for typos
or mistakes in the variable name, which is case sensitive.</p>
<p>Use these filters for common changes to capitalization:</p>
<table><thead><tr><th>Purpose</th><th>Filter</th><th>Example</th></tr></thead><tbody><tr><td>Capitalize all letters</td><td><code>upper</code></td><td><code>{{ some_variable | upper }}</code></td></tr><tr><td>Make all letters lowercase</td><td><code>lower</code></td><td><code>{{ some_variable | lower }}</code></td></tr><tr><td>Capitalize just the first letter</td><td><code>capitalize</code></td><td><code>{{ some_variable | capitalize }}</code></td></tr><tr><td>Capitalize just the first letter of each word</td><td><code>title</code></td><td><code>{{ some_variable | title }}</code></td></tr></tbody></table>
<p>Note that the &quot;title&quot; filter is not smart enough to follow <a href="https://apastyle.apa.org/style-grammar-guidelines/capitalization/title-case" target="_blank" rel="noopener noreferrer">standard grammatical
rules</a>.
It will simply capitalize the first letter of every word.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-fix_punctuation-to-add-an-ending-">Use <code>fix_punctuation()</code> to add an ending <code>.</code><a href="#use-fix_punctuation-to-add-an-ending-" class="hash-link" aria-label="Direct link to use-fix_punctuation-to-add-an-ending-" title="Direct link to use-fix_punctuation-to-add-an-ending-">​</a></h3>
<p>The <a href="https://docassemble.org/docs/functions.html#fix_punctuation" target="_blank" rel="noopener noreferrer"><code>fix_punctuation()</code></a> function can help you add an ending <code>.</code> without
risking adding an extra one to the user&#x27;s provided text.</p>
<p>For example:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">I need this order because:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ fix_punctuation(order_reason) }}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tips-for-dealing-with-formatting-issues-caused-by-variable-length-documents-in-word">Tips for dealing with formatting issues caused by variable-length documents in Word<a href="#tips-for-dealing-with-formatting-issues-caused-by-variable-length-documents-in-word" class="hash-link" aria-label="Direct link to Tips for dealing with formatting issues caused by variable-length documents in Word" title="Direct link to Tips for dealing with formatting issues caused by variable-length documents in Word">​</a></h2>
<p>When working with documents that are tightly formatted, it&#x27;s important to test
with both short and long amounts of text and with different numbers of repeated fields.</p>
<p>Usually, the best place to control these is inside the Word document itself.</p>
<p>Repeated items in a list can often reveal formatting problems in the underlying document, as can long text inputs or even long names.</p>
<p>For example, a long name can bump text down to a new line. This may break
paragraphs you intended to be together on a single page across multiple pages.</p>
<p>You will need to make choices about whether and how you want to control these problems in the template and which problems you are okay with leaving to resolve until the attorney or user edits it manually. You will inevitably have some of these choices to make.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-keep-lines-together-and-keep-with-next-for-notary-blocks-signature-blocks-and-other-text-that-cant-split-across-pages">Use &quot;keep lines together&quot; and &quot;keep with next&quot; for notary blocks, signature blocks, and other text that can&#x27;t split across pages<a href="#use-keep-lines-together-and-keep-with-next-for-notary-blocks-signature-blocks-and-other-text-that-cant-split-across-pages" class="hash-link" aria-label="Direct link to Use &quot;keep lines together&quot; and &quot;keep with next&quot; for notary blocks, signature blocks, and other text that can&#x27;t split across pages" title="Direct link to Use &quot;keep lines together&quot; and &quot;keep with next&quot; for notary blocks, signature blocks, and other text that can&#x27;t split across pages">​</a></h3>
<p>Microsoft Word has <a href="https://support.microsoft.com/en-us/office/keep-text-together-af94e5b8-3a5a-4cb0-9c53-dea56b43d96d" target="_blank" rel="noopener noreferrer">several features</a>
that can be used to control when a paragraph is able to break across multiple pages.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-manual-page-breaks-rather-than-extra-typed-paragraphs">Use manual page breaks rather than extra typed paragraphs<a href="#use-manual-page-breaks-rather-than-extra-typed-paragraphs" class="hash-link" aria-label="Direct link to Use manual page breaks rather than extra typed paragraphs" title="Direct link to Use manual page breaks rather than extra typed paragraphs">​</a></h3>
<p><a href="https://support.microsoft.com/en-us/office/insert-a-page-break-in-word-eb0e569c-8e3f-4db4-9b13-7bfe1cabdbd7" target="_blank" rel="noopener noreferrer">Insert a manual page break</a> when you want
text to be at the top of its own page, rather than relying on the current amount
of text to flow onto a new page automatically.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-lists-inside-a-docx-file">Working with lists inside a DOCX file<a href="#working-with-lists-inside-a-docx-file" class="hash-link" aria-label="Direct link to Working with lists inside a DOCX file" title="Direct link to Working with lists inside a DOCX file">​</a></h2>
<p>Unfortunately, if you&#x27;ve gotten used to using <a href="https://docs.python.org/3/tutorial/datastructures.html" target="_blank" rel="noopener noreferrer">list comprehensions</a> to filter and manage
working with lists, you cannot use list comprehensions
in a DOCX file.</p>
<p>There are a few alternatives to use when dealing with a subset
of a list, described below.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="iterate-over-every-item-in-the-list">Iterate over every item in the list<a href="#iterate-over-every-item-in-the-list" class="hash-link" aria-label="Direct link to Iterate over every item in the list" title="Direct link to Iterate over every item in the list">​</a></h3>
<p>Jinja2 supports the standard <code>for</code> loop construct from Python. See: <a href="https://jinja.palletsprojects.com/en/3.0.x/templates/#for" target="_blank" rel="noopener noreferrer">https://jinja.palletsprojects.com/en/3.0.x/templates/#for</a>.</p>
<p>You&#x27;ll normally use <code>{%p for temporary_variable in list_name %} ... {%p endfor %}</code> to loop over the items in a list.</p>
<p>Example:</p>
<div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p for child in children %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ child }} was born on {{ child.birthdate }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endfor %}</span><br></span></code></pre></div></div>
<p><code>child</code> is a temporary variable that updates with a new item of the list each time the loop
runs through.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-index-of-the-current-loop">Get the index of the current loop<a href="#get-the-index-of-the-current-loop" class="hash-link" aria-label="Direct link to Get the index of the current loop" title="Direct link to Get the index of the current loop">​</a></h3>
<p>In Jinja2, there are 2 separate special variables that you can access that represent the current
position in the list:</p>
<ol>
<li><code>loop.index</code>, which starts with the number 1, for the first item in the list</li>
<li><code>loop.index0</code>, which starts with the number 0 for the first item in the list</li>
</ol>
<p>More special variables with information about the list are <a href="https://jinja.palletsprojects.com/en/3.0.x/templates/#for" target="_blank" rel="noopener noreferrer">documented here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-the-list-at-a-certain-startingending-value">Use the list at a certain starting/ending value<a href="#use-the-list-at-a-certain-startingending-value" class="hash-link" aria-label="Direct link to Use the list at a certain starting/ending value" title="Direct link to Use the list at a certain starting/ending value">​</a></h3>
<p>You can use Python&#x27;s normal list &quot;slices&quot; to shorten the size of the list you display
in the template, as well as list indices to get just one item.</p>
<p>The basic syntax of a list &quot;slice&quot; is to put the starting and ending index inside
the brackets. You can leave off either the starting or ending digit to get everything up
to/before that index, or you can specify negative numbers to count backwards.</p>
<ul>
<li>list[1:] starts at index 1 in the list and returns everything after that index.</li>
<li>list[:5] gets items at the indices 0-4.</li>
<li>list[1:3] returns a list with the items at indices 1 and 2.</li>
<li>list[2] returns just the item at index 2 (not a list of items).</li>
<li>list[:-1] returns every item except the final item in the list.</li>
<li>list[-1] returns only the last item in the list.</li>
</ul>
<div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">1. Primary agent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Primary agent&#x27;s name: {{ agents[0] }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p for agent in agents[1:] %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2. {{ ordinal(loop.index0) }} Backup Agent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ agent }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endfor %}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="filter-the-list-with-dalistfilter">Filter the list with DAList.filter()<a href="#filter-the-list-with-dalistfilter" class="hash-link" aria-label="Direct link to Filter the list with DAList.filter()" title="Direct link to Filter the list with DAList.filter()">​</a></h3>
<p>You can do very simple filtering of a list with the <code>.filter()</code> method.</p>
<p>For example, suppose every item in the list <code>my_list</code> has an attribute
<code>is_employed</code> that can be True or False:</p>
<div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">1. People with jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p for person in my_list.filter(is_employed=True) %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ person }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{%p endfor %}</span><br></span></code></pre></div></div>
<p>This only works for checking one attribute, and one value. You can use <code>selecattr</code>, described below,
for more complex situations. One benefit of <code>filter()</code> is that the result will be of the special Docassemble
DAList class.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-sum-with-the-sum-filter">Create a sum with the <code>sum</code> filter<a href="#create-a-sum-with-the-sum-filter" class="hash-link" aria-label="Direct link to create-a-sum-with-the-sum-filter" title="Direct link to create-a-sum-with-the-sum-filter">​</a></h3>
<p>If you have a list of objects that each have a number stored in an attribute, you can use the <code>sum</code> filter to add the
values altogether.</p>
<p>You may also want to use the <code>currency()</code> function to format
the number as currency.</p>
<p>Example:</p>
<p><code>{{ currency(incomes | sum(attribute=&#x27;amount&#x27;)) }}</code></p>
<p>Note that the filter, <code>sum</code>, can appear in-line in the expression and then the result of the list with the filter can be passed as a parameter to the <code>currency()</code> function.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-selectattr-for-more-complex-comparisons">Use <code>selectattr</code> for more complex comparisons<a href="#use-selectattr-for-more-complex-comparisons" class="hash-link" aria-label="Direct link to use-selectattr-for-more-complex-comparisons" title="Direct link to use-selectattr-for-more-complex-comparisons">​</a></h3>
<p>The <a href="https://jinja.palletsprojects.com/en/3.0.x/templates/#jinja-filters.selectattr" target="_blank" rel="noopener noreferrer"><code>selectattr</code></a> filter can be used to narrow a list down to only those items
that have a particular attribute value. There&#x27;s a shortcut for a <code>True</code>/<code>False</code> value:</p>
<p><code>{{ users | selectattr(&quot;is_active&quot;) }}</code></p>
<p>Or the longer version to check for a particular exact value:</p>
<p><code>{{ users | selectattr(&quot;email&quot;, &quot;none&quot;) }}</code></p>
<p>If you need to check for 1 of 2 possible values, you can use the <code>&quot;in&quot;</code> parameter
and provide a list of choices:</p>
<div class="language-jinja codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{% for applicant in applicants | selectattr(&#x27;status&#x27;, &#x27;in&#x27;, [&#x27;approved&#x27;, &#x27;conditionally_approved&#x27;]) %}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* {{ applicant.name }} - {{ applicant.birthdate.format(&quot;MM/dd/yyyy&quot;) }}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{% endfor %}</span><br></span></code></pre></div></div>
<p>Notice that the name of the attribute goes in quotes.</p>
<p>In addition to <code>in</code>, you can use any of the <a href="https://jinja.palletsprojects.com/en/3.0.x/templates/#list-of-builtin-tests" target="_blank" rel="noopener noreferrer">Jinja2 &quot;tests&quot; documented here</a>.</p>
<p>You can also combine multiple <code>selectattr</code> filters in a series, like:</p>
<p><code>{{ my_list | selecattr(&quot;test1&quot;) | selecattr(&quot;test2&quot;) }}</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-docx-files">Troubleshooting DOCX files<a href="#troubleshooting-docx-files" class="hash-link" aria-label="Direct link to Troubleshooting DOCX files" title="Direct link to Troubleshooting DOCX files">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fixing-corrupt-or-potentially-corrupt-docx-files">Fixing corrupt or potentially corrupt DOCX files<a href="#fixing-corrupt-or-potentially-corrupt-docx-files" class="hash-link" aria-label="Direct link to Fixing corrupt or potentially corrupt DOCX files" title="Direct link to Fixing corrupt or potentially corrupt DOCX files">​</a></h3>
<p>You can fix some hard to track down problems in a DOCX file by converting to a simpler format, such
as RTF, and then converting back to DOCX. These problems might only appear when you merge multiple DOCX files together and be silently fixed when you open just one at a time.
This is sometimes caused by using Google Docs, which reliably produces DOCX files that don&#x27;t
meet the full DOCX technical specification.</p>
<p>To try this fix:</p>
<ol>
<li>Open the document in Microsoft Word or Libre Office</li>
<li>Choose File | Save as, and select &quot;RTF - Rich Text Format&quot; as the file type</li>
<li>Close your word processor</li>
<li>Open the file with the newly added .RTF extension</li>
<li>Save the file back to Microsoft Word - DOCX format.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-problems-with-conversion-to-pdf">Troubleshooting problems with conversion to PDF<a href="#troubleshooting-problems-with-conversion-to-pdf" class="hash-link" aria-label="Direct link to Troubleshooting problems with conversion to PDF" title="Direct link to Troubleshooting problems with conversion to PDF">​</a></h3>
<p>Sometimes the DOCX will look right, but things like headings, numberings, and other
styles will look off when Docassemble converts your template to PDF.</p>
<p>The first thing to check when troubleshooting a DOCX conversion to PDF is to see
how the document looks in <a href="https://www.libreoffice.org/" target="_blank" rel="noopener noreferrer">Libre Office</a>. Docassemble
uses Libre Office to convert DOCX to PDF, so if you can fix issues in Libre Office
on your home computer, it should look right when Docassemble converts it to PDF on the
server.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-proper-fonts">Installing the proper fonts<a href="#installing-the-proper-fonts" class="hash-link" aria-label="Direct link to Installing the proper fonts" title="Direct link to Installing the proper fonts">​</a></h4>
<p>One issue you may find is that the PDF doesn&#x27;t have the right fonts. There are two potential
solutions:</p>
<ol>
<li>You can revise your document to use the Microsoft True Type Core Fonts for the Web, which come pre-installed on Docassemble servers. These include Arial and Times New Roman.</li>
<li>You can install the fonts on the Docassemble server. The <a href="https://github.com/SuffolkLITLab/docassemble-ALDashboard" target="_blank" rel="noopener noreferrer">ALDashboard</a>&#x27;s &quot;Install fonts&quot; widget can help you install a TTF (TrueType)
font on your server.</li>
<li>You can <a href="https://support.microsoft.com/en-us/office/benefits-of-embedding-custom-fonts-cb3982aa-ea76-4323-b008-86670f222dbc" target="_blank" rel="noopener noreferrer">embed the fonts</a> inside the DOCX file.
This might significantly increase the file size.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problems-with-lists-and-numbering-after-automation">Problems with lists and numbering after automation<a href="#problems-with-lists-and-numbering-after-automation" class="hash-link" aria-label="Direct link to Problems with lists and numbering after automation" title="Direct link to Problems with lists and numbering after automation">​</a></h3>
<p>Multi-level numbered and lettered lists are a frequent problem spot. On occasion, the
only way to fix the list in your template is to copy all of the text, paste into a new document
as unformatted text, and then re-apply all of the formatting (or at least the list formatting)
manually.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quality-control-checklist">Quality control checklist<a href="#quality-control-checklist" class="hash-link" aria-label="Direct link to Quality control checklist" title="Direct link to Quality control checklist">​</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->The DOCX template has valid Jinja syntax. You can use the <a href="https://github.com/SuffolkLITLab/docassemble-ALDashboard" target="_blank" rel="noopener noreferrer">ALDashboard</a>&#x27;s &quot;Validate DOCX template&quot; widget,
installed on your own Docassemble server, to check.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->All of the expected standard field names are recognized by the Weaver (marked in bold when you upload and view the quality control screen)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Custom field names are all properly spelled, without typos</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Run the interview with short, long, and one and many items for repeated lists to ensure that the full range of common scenarios looks proper.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Check choices that can trigger conditional text to make sure white space is correct across all conditions. It&#x27;s easy to add an extra space when using in-line conditions.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/SuffolkLITLab/docassemble-AssemblyLine-documentation/edit/main/docs/authoring/docx_templates.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/authoring/pdfs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Working with PDF files</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/authoring/dynamic_phrasing_based_on_values"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dynamic phrasing based on values</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#docx-field-labels-are-just-typed-in" class="table-of-contents__link toc-highlight">DOCX field labels are just typed in</a></li><li><a href="#start-by-just-adding-the-basic-variables-in-your-docx-template-without-repeated-elements-or-advanced-code" class="table-of-contents__link toc-highlight">Start by just adding the basic variables in your DOCX template, without repeated elements or advanced code</a></li><li><a href="#use-the-assembly-lines-standard-field-names-for-docx-templates" class="table-of-contents__link toc-highlight">Use the Assembly Line&#39;s standard field names for DOCX templates</a></li><li><a href="#use-a-space-before-and-after-the-variable-name-in-the-field-statements" class="table-of-contents__link toc-highlight">Use a space before and after the variable name in the field statements</a></li><li><a href="#dealing-with-whitespace-and-conditional-text" class="table-of-contents__link toc-highlight">Dealing with whitespace and conditional text</a><ul><li><a href="#use-p--and-tr--to-control-white-space-at-the-paragraph-level" class="table-of-contents__link toc-highlight">Use <code>{%p %}</code> and <code>{%tr %}</code> to control white space at the paragraph level</a></li><li><a href="#use--if--for-conditional-text-inside-a-single-paragraph" class="table-of-contents__link toc-highlight">Use <code>{% if %}</code> for conditional text inside a single paragraph</a></li><li><a href="#use-output_checkbox-for-conditional-checkbox-fields-that-look-like-paper-forms" class="table-of-contents__link toc-highlight">Use <code>output_checkbox()</code> for conditional checkbox fields that look like paper forms</a></li></ul></li><li><a href="#changing-the-appearance-of-inserted-variable-text" class="table-of-contents__link toc-highlight">Changing the appearance of inserted variable text</a><ul><li><a href="#start-with-microsoft-words-formatting-for-simple-use-cases" class="table-of-contents__link toc-highlight">Start with Microsoft Word&#39;s formatting for simple use cases</a></li><li><a href="#use-filters-functions-and-methods-for-advanced-changes-to-variables" class="table-of-contents__link toc-highlight">Use filters, functions, and methods for advanced changes to variables</a></li><li><a href="#use-jinja2-filters-to-change-capitalization" class="table-of-contents__link toc-highlight">Use Jinja2 filters to change capitalization</a></li><li><a href="#use-fix_punctuation-to-add-an-ending-" class="table-of-contents__link toc-highlight">Use <code>fix_punctuation()</code> to add an ending <code>.</code></a></li></ul></li><li><a href="#tips-for-dealing-with-formatting-issues-caused-by-variable-length-documents-in-word" class="table-of-contents__link toc-highlight">Tips for dealing with formatting issues caused by variable-length documents in Word</a><ul><li><a href="#use-keep-lines-together-and-keep-with-next-for-notary-blocks-signature-blocks-and-other-text-that-cant-split-across-pages" class="table-of-contents__link toc-highlight">Use &quot;keep lines together&quot; and &quot;keep with next&quot; for notary blocks, signature blocks, and other text that can&#39;t split across pages</a></li><li><a href="#use-manual-page-breaks-rather-than-extra-typed-paragraphs" class="table-of-contents__link toc-highlight">Use manual page breaks rather than extra typed paragraphs</a></li></ul></li><li><a href="#working-with-lists-inside-a-docx-file" class="table-of-contents__link toc-highlight">Working with lists inside a DOCX file</a><ul><li><a href="#iterate-over-every-item-in-the-list" class="table-of-contents__link toc-highlight">Iterate over every item in the list</a></li><li><a href="#get-the-index-of-the-current-loop" class="table-of-contents__link toc-highlight">Get the index of the current loop</a></li><li><a href="#use-the-list-at-a-certain-startingending-value" class="table-of-contents__link toc-highlight">Use the list at a certain starting/ending value</a></li><li><a href="#filter-the-list-with-dalistfilter" class="table-of-contents__link toc-highlight">Filter the list with DAList.filter()</a></li><li><a href="#create-a-sum-with-the-sum-filter" class="table-of-contents__link toc-highlight">Create a sum with the <code>sum</code> filter</a></li><li><a href="#use-selectattr-for-more-complex-comparisons" class="table-of-contents__link toc-highlight">Use <code>selectattr</code> for more complex comparisons</a></li></ul></li><li><a href="#troubleshooting-docx-files" class="table-of-contents__link toc-highlight">Troubleshooting DOCX files</a><ul><li><a href="#fixing-corrupt-or-potentially-corrupt-docx-files" class="table-of-contents__link toc-highlight">Fixing corrupt or potentially corrupt DOCX files</a></li><li><a href="#troubleshooting-problems-with-conversion-to-pdf" class="table-of-contents__link toc-highlight">Troubleshooting problems with conversion to PDF</a></li><li><a href="#problems-with-lists-and-numbering-after-automation" class="table-of-contents__link toc-highlight">Problems with lists and numbering after automation</a></li></ul></li><li><a href="#quality-control-checklist" class="table-of-contents__link toc-highlight">Quality control checklist</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://suffolklitlab.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Suffolk LIT Lab<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> | This documentation website is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>